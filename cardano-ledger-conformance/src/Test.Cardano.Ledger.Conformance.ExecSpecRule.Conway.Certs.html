<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Certs</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Certs.html#nameCerts"><span class="hs-identifier">nameCerts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">Cardano.Ledger.Conway</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">Cardano.Ledger.Conway.TxCert</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier">Constrained</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier">Lib</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Agda</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.html"><span class="hs-identifier">Test.Cardano.Ledger.Conformance</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Base.html"><span class="hs-identifier">Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Base</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Constrained.Conway</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Test.Cardano.Ledger.Imp.Common</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/hspec-core-2.11.9-341f7cbdbfb79a82c773ee031a1c9fdbd4be25f8ad76a92abdfce28033f0549c/share/doc/html/src"><span class="hs-identifier">context</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-30"></span><span>  </span><span id="local-6989586621679811673"><span id="local-6989586621679811676"><span id="local-6989586621679811679"><span id="local-6989586621679811887"><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-type">IsConwayUniv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#ExecSpecRule"><span class="hs-identifier hs-type">ExecSpecRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;CERTS&quot;</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span></span></span></span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExecContext"><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#ExecContext"><span class="hs-identifier hs-var">ExecContext</span></a></span></span><span> </span><span id="local-6989586621679811887"><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;CERTS&quot;</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Base.html#ConwayCertExecContext"><span class="hs-identifier hs-type">ConwayCertExecContext</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>  </span><span id="local-6989586621679811442"><span class="annot"><span class="annottext">environmentSpec :: HasCallStack =&gt;
ExecContext fn &quot;CERTS&quot; Conway
-&gt; Specification fn (ExecEnvironment fn &quot;CERTS&quot; Conway)
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#environmentSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">environmentSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
IsConwayUniv fn =&gt;
Specification fn (CertsEnv Conway)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-var">certsEnvSpec</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679811383"><span class="annot"><span class="annottext">stateSpec :: HasCallStack =&gt;
ExecContext fn &quot;CERTS&quot; Conway
-&gt; ExecEnvironment fn &quot;CERTS&quot; Conway
-&gt; Specification fn (ExecState fn &quot;CERTS&quot; Conway)
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#stateSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">stateSpec</span></a></span></span><span> </span><span id="local-6989586621679811381"><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811381"><span class="hs-identifier hs-var">context</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Specification fn a
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679811379"><span class="annot"><span class="annottext">Term fn (ExecState fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811379"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p a.
(HasSpec fn a, IsProductType fn a, IsPred p fn) =&gt;
Term fn a
-&gt; FunTy (MapList (Term fn) (ProductAsList a)) p -&gt; Pred fn
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (ExecState fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811379"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679811377"><span class="annot"><span class="annottext">Term fn (VState Conway)
</span><a href="#local-6989586621679811377"><span class="hs-identifier hs-var">vstate</span></a></span></span><span> </span><span id="local-6989586621679811376"><span class="annot"><span class="annottext">Term fn (PState Conway)
</span><a href="#local-6989586621679811376"><span class="hs-identifier hs-var">pstate</span></a></span></span><span> </span><span id="local-6989586621679811375"><span class="annot"><span class="annottext">Term fn (DState Conway)
</span><a href="#local-6989586621679811375"><span class="hs-identifier hs-var">dstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Specification fn a -&gt; Pred fn
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (VState Conway)
</span><a href="#local-6989586621679811377"><span class="hs-identifier hs-var">vstate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Specification fn (VState Conway)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-var">vStateSpec</span></a></span><span>
</span><span id="line-41"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Specification fn a -&gt; Pred fn
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (PState Conway)
</span><a href="#local-6989586621679811376"><span class="hs-identifier hs-var">pstate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
IsConwayUniv fn =&gt;
Specification fn (PState Conway)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-var">pStateSpec</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- temporary workaround because Spec does some extra tests, that the implementation does not, in the bootstrap phase.</span><span>
</span><span id="line-43"></span><span>          </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Specification fn a -&gt; Pred fn
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/constrained-generators-0.2.0.0/doc/html/constrained-generators/src"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (DState Conway)
</span><a href="#local-6989586621679811375"><span class="hs-identifier hs-var">dstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
IsConwayUniv fn =&gt;
Map (Network, Credential 'Staking (EraCrypto Conway)) Coin
-&gt; Specification fn (DState Conway)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-var">bootstrapDStateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ConwayCertExecContext era
-&gt; Map (Network, Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Base.html#ccecWithdrawals"><span class="hs-identifier hs-var">ccecWithdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811381"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679811367"><span class="annot"><span class="annottext">signalSpec :: HasCallStack =&gt;
ExecContext fn &quot;CERTS&quot; Conway
-&gt; ExecEnvironment fn &quot;CERTS&quot; Conway
-&gt; ExecState fn &quot;CERTS&quot; Conway
-&gt; Specification fn (ExecSignal fn &quot;CERTS&quot; Conway)
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#signalSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">signalSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679811365"><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811365"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679811364"><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811364"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
IsConwayUniv fn =&gt;
CertsEnv Conway
-&gt; CertState Conway -&gt; Specification fn (Seq (ConwayTxCert Conway))
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-test-9.9.9.9/doc/html/cardano-ledger-test/src"><span class="hs-identifier hs-var">txCertsSpec</span></a></span><span> </span><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811365"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811364"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679811359"><span class="annot"><span class="annottext">runAgdaRule :: HasCallStack =&gt;
SpecRep (ExecEnvironment fn &quot;CERTS&quot; Conway)
-&gt; SpecRep (ExecState fn &quot;CERTS&quot; Conway)
-&gt; SpecRep (ExecSignal fn &quot;CERTS&quot; Conway)
-&gt; Either
     (NonEmpty (SpecRep (PredicateFailure (EraRule &quot;CERTS&quot; Conway))))
     (SpecRep (ExecState fn &quot;CERTS&quot; Conway))
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#runAgdaRule"><span class="hs-identifier hs-var hs-var hs-var hs-var">runAgdaRule</span></a></span></span><span> </span><span id="local-6989586621679811357"><span class="annot"><span class="annottext">SpecRep (ExecEnvironment fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811357"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679811356"><span class="annot"><span class="annottext">SpecRep (ExecState fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811356"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679811355"><span class="annot"><span class="annottext">SpecRep (ExecSignal fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811355"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679811354"><span class="annot"><span class="annottext">T_String_6
</span><a href="#local-6989586621679811354"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; OpaqueErrorString
</span><a href="Test.Cardano.Ledger.Conformance.SpecTranslate.Core.html#OpaqueErrorString"><span class="hs-identifier hs-var">OpaqueErrorString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">T_String_6 -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">T_String_6
</span><a href="#local-6989586621679811354"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">NE.:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall e a. ComputationResult e a -&gt; Either e a
</span><a href="Test.Cardano.Ledger.Conformance.Utils.html#computationResultToEither"><span class="hs-identifier hs-var">computationResultToEither</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CertEnv'
-&gt; CertState'
-&gt; [TxCert]
-&gt; T_ComputationResult_12 T_String_6 CertState'
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.certsStep'</span></a></span><span> </span><span class="annot"><span class="annottext">SpecRep (ExecEnvironment fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811357"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">SpecRep (ExecState fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811356"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SpecRep (ExecSignal fn &quot;CERTS&quot; Conway)
</span><a href="#local-6989586621679811355"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679811348"><span class="annot"><span class="annottext">classOf :: ExecSignal fn &quot;CERTS&quot; Conway -&gt; Maybe String
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#classOf"><span class="hs-identifier hs-var hs-var hs-var hs-var">classOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (ConwayTxCert Conway) -&gt; String
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Certs.html#nameCerts"><span class="hs-identifier hs-var">nameCerts</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679811255"><span class="annot"><span class="annottext">testConformance :: (ShelleyEraImp Conway,
 SpecTranslate
   (ExecContext fn &quot;CERTS&quot; Conway) (State (EraRule &quot;CERTS&quot; Conway)),
 ForAllExecSpecRep NFData fn &quot;CERTS&quot; Conway,
 ForAllExecSpecRep ToExpr fn &quot;CERTS&quot; Conway,
 NFData (SpecRep (PredicateFailure (EraRule &quot;CERTS&quot; Conway))),
 ToExpr (SpecRep (PredicateFailure (EraRule &quot;CERTS&quot; Conway))),
 Eq (SpecRep (PredicateFailure (EraRule &quot;CERTS&quot; Conway))),
 Eq (SpecRep (ExecState fn &quot;CERTS&quot; Conway)),
 Inject
   (State (EraRule &quot;CERTS&quot; Conway)) (ExecState fn &quot;CERTS&quot; Conway),
 SpecTranslate
   (ExecContext fn &quot;CERTS&quot; Conway) (ExecState fn &quot;CERTS&quot; Conway),
 FixupSpecRep (SpecRep (PredicateFailure (EraRule &quot;CERTS&quot; Conway))),
 FixupSpecRep (SpecRep (ExecState fn &quot;CERTS&quot; Conway)),
 Inject
   (ExecEnvironment fn &quot;CERTS&quot; Conway)
   (Environment (EraRule &quot;CERTS&quot; Conway)),
 Inject
   (ExecState fn &quot;CERTS&quot; Conway) (State (EraRule &quot;CERTS&quot; Conway)),
 Inject
   (ExecSignal fn &quot;CERTS&quot; Conway) (Signal (EraRule &quot;CERTS&quot; Conway)),
 EncCBOR (ExecContext fn &quot;CERTS&quot; Conway),
 EncCBOR (Environment (EraRule &quot;CERTS&quot; Conway)),
 EncCBOR (State (EraRule &quot;CERTS&quot; Conway)),
 EncCBOR (Signal (EraRule &quot;CERTS&quot; Conway)),
 ToExpr (ExecContext fn &quot;CERTS&quot; Conway), HasCallStack) =&gt;
ExecContext fn &quot;CERTS&quot; Conway
-&gt; ExecEnvironment fn &quot;CERTS&quot; Conway
-&gt; ExecState fn &quot;CERTS&quot; Conway
-&gt; ExecSignal fn &quot;CERTS&quot; Conway
-&gt; Property
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#testConformance"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConformance</span></a></span></span><span> </span><span id="local-6989586621679811253"><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811253"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679811252"><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811252"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679811251"><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811251"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679811250"><span class="annot"><span class="annottext">ExecSignal fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811250"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">-- The results of runConformance are Agda types, the `ctx` is a Haskell type, we extract and translate the Withdrawal keys.</span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621679811248"><span class="annot"><span class="annottext">HSSet Credential
</span><a href="#local-6989586621679811248"><span class="hs-identifier hs-var">specWithdrawalCredSet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">forall ctx a era.
SpecTranslate ctx a =&gt;
ctx -&gt; a -&gt; ImpTestM era (SpecRep a)
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#translateWithContext"><span class="hs-identifier hs-var">translateWithContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.mapKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ConwayCertExecContext era
-&gt; Map (Network, Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Base.html#ccecWithdrawals"><span class="hs-identifier hs-var">ccecWithdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811253"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679811244"><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811244"><span class="hs-identifier hs-var">implResTest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679811243"><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811243"><span class="hs-identifier hs-var">agdaResTest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (rule :: Symbol) (fn :: [*] -&gt; * -&gt; *) era.
(ExecSpecRule fn rule era,
 NFData (SpecRep (PredicateFailure (EraRule rule era))),
 ForAllExecSpecRep NFData fn rule era,
 ForAllExecSpecRep ToExpr fn rule era,
 FixupSpecRep (SpecRep (PredicateFailure (EraRule rule era))),
 FixupSpecRep (SpecRep (ExecState fn rule era)),
 Inject (State (EraRule rule era)) (ExecState fn rule era),
 SpecTranslate (ExecContext fn rule era) (ExecState fn rule era),
 ToExpr (ExecContext fn rule era), HasCallStack) =&gt;
ExecContext fn rule era
-&gt; ExecEnvironment fn rule era
-&gt; ExecState fn rule era
-&gt; ExecSignal fn rule era
-&gt; ImpTestM
     era
     (Either
        (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
        (SpecRep (ExecState fn rule era)),
      Either
        (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
        (SpecRep (ExecState fn rule era)))
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#runConformance"><span class="hs-identifier hs-var">runConformance</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;CERTS&quot;</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811253"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811252"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811251"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">ExecSignal fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811250"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811244"><span class="hs-identifier hs-var">implResTest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811243"><span class="hs-identifier hs-var">agdaResTest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679811241"><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811241"><span class="hs-identifier hs-var">haskell</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679811240"><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811240"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><span class="annottext">forall (rule :: Symbol) era (fn :: [*] -&gt; * -&gt; *).
(Era era, ToExpr (SpecRep (PredicateFailure (EraRule rule era))),
 ToExpr (SpecRep (ExecState fn rule era)),
 Eq (SpecRep (PredicateFailure (EraRule rule era))),
 Eq (SpecRep (ExecState fn rule era)),
 EncCBOR (ExecContext fn rule era),
 EncCBOR (Environment (EraRule rule era)),
 EncCBOR (State (EraRule rule era)),
 EncCBOR (Signal (EraRule rule era)), HasCallStack) =&gt;
ExecContext fn rule era
-&gt; Environment (EraRule rule era)
-&gt; State (EraRule rule era)
-&gt; Signal (EraRule rule era)
-&gt; Either
     (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
     (SpecRep (ExecState fn rule era))
-&gt; Either
     (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
     (SpecRep (ExecState fn rule era))
-&gt; ImpTestM era ()
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#checkConformance"><span class="hs-identifier hs-var">checkConformance</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;CERTS&quot;</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-62"></span><span>          </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811253"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811252"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-64"></span><span>          </span><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811251"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-65"></span><span>          </span><span class="annot"><span class="annottext">ExecSignal fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811250"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-66"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HSSet Credential -&gt; CertState' -&gt; CertState'
</span><a href="#local-6989586621679811238"><span class="hs-identifier hs-var">fixRewards</span></a></span><span> </span><span class="annot"><span class="annottext">HSSet Credential
</span><a href="#local-6989586621679811248"><span class="hs-identifier hs-var">specWithdrawalCredSet</span></a></span><span> </span><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811241"><span class="hs-identifier hs-var">haskell</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811240"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>          </span><span class="hs-comment">-- Zero out the rewards for credentials that are the key of some withdrawal</span><span>
</span><span id="line-70"></span><span>          </span><span class="hs-comment">-- (found in the ctx) as this happens in the Spec, but not in the implementation.</span><span>
</span><span id="line-71"></span><span>          </span><span id="local-6989586621679811238"><span class="annot"><span class="annottext">fixRewards :: HSSet Credential -&gt; CertState' -&gt; CertState'
</span><a href="#local-6989586621679811238"><span class="hs-identifier hs-var hs-var">fixRewards</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-type">Agda.MkHSSet</span></a></span><span> </span><span id="local-6989586621679811230"><span class="annot"><span class="annottext">[Credential]
</span><a href="#local-6989586621679811230"><span class="hs-identifier hs-var">creds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679811229"><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811229"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>            </span><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dState' :: DState'
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.dState'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertState' -&gt; DState'
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.dState'</span></a></span><span> </span><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811229"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rewards' :: HSMap Credential Coin
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.rewards'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HSMap Credential Coin -&gt; HSMap Credential Coin
</span><a href="#local-6989586621679811226"><span class="hs-identifier hs-var">zeroRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DState' -&gt; HSMap Credential Coin
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.rewards'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertState' -&gt; DState'
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.dState'</span></a></span><span> </span><span class="annot"><span class="annottext">CertState'
</span><a href="#local-6989586621679811229"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>              </span><span id="local-6989586621679811226"><span class="annot"><span class="annottext">zeroRewards :: HSMap Credential Coin -&gt; HSMap Credential Coin
</span><a href="#local-6989586621679811226"><span class="hs-identifier hs-var hs-var">zeroRewards</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-type">Agda.MkHSMap</span></a></span><span> </span><span id="local-6989586621679811224"><span class="annot"><span class="annottext">[(Credential, Coin)]
</span><a href="#local-6989586621679811224"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. [(k, v)] -&gt; HSMap k v
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-ledger-executable-spec-0.1.0.0-e5f12fe97d59d4303244770e393dca6beb4052be322ec02fe9b613031267006d/share/doc/html/src"><span class="hs-identifier hs-var">Agda.MkHSMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679811223"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679811223"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679811222"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679811222"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679811223"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential]
</span><a href="#local-6989586621679811230"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679811223"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679811223"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679811222"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Credential, Coin)]
</span><a href="#local-6989586621679811224"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">(Either (NonEmpty OpaqueErrorString) CertState',
 Either (NonEmpty OpaqueErrorString) CertState')
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (rule :: Symbol) era (fn :: [*] -&gt; * -&gt; *).
(Era era, ToExpr (SpecRep (PredicateFailure (EraRule rule era))),
 ToExpr (SpecRep (ExecState fn rule era)),
 Eq (SpecRep (PredicateFailure (EraRule rule era))),
 Eq (SpecRep (ExecState fn rule era)),
 EncCBOR (ExecContext fn rule era),
 EncCBOR (Environment (EraRule rule era)),
 EncCBOR (State (EraRule rule era)),
 EncCBOR (Signal (EraRule rule era)), HasCallStack) =&gt;
ExecContext fn rule era
-&gt; Environment (EraRule rule era)
-&gt; State (EraRule rule era)
-&gt; Signal (EraRule rule era)
-&gt; Either
     (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
     (SpecRep (ExecState fn rule era))
-&gt; Either
     (NonEmpty (SpecRep (PredicateFailure (EraRule rule era))))
     (SpecRep (ExecState fn rule era))
-&gt; ImpTestM era ()
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Core.html#checkConformance"><span class="hs-identifier hs-var">checkConformance</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;CERTS&quot;</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811887"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">ExecContext fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811253"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ExecEnvironment fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811252"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">ExecState fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811251"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">ExecSignal fn &quot;CERTS&quot; Conway
</span><a href="#local-6989586621679811250"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811244"><span class="hs-identifier hs-var">implResTest</span></a></span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty OpaqueErrorString) CertState'
</span><a href="#local-6989586621679811243"><span class="hs-identifier hs-var">agdaResTest</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Certs.html#nameCerts"><span class="hs-identifier hs-type">nameCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCert</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">Conway</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-78"></span><span id="nameCerts"><span class="annot"><span class="annottext">nameCerts :: Seq (ConwayTxCert Conway) -&gt; String
</span><a href="Test.Cardano.Ledger.Conformance.ExecSpecRule.Conway.Certs.html#nameCerts"><span class="hs-identifier hs-var hs-var">nameCerts</span></a></span></span><span> </span><span id="local-6989586621679811220"><span class="annot"><span class="annottext">Seq (ConwayTxCert Conway)
</span><a href="#local-6989586621679811220"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Certs length &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (ConwayTxCert Conway)
</span><a href="#local-6989586621679811220"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span></pre></body></html>