<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621685087094"><span id="local-6989586621685087095"></span></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- | Strategy for Generic Tests</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   Make the GenState include a Mode of the NewEpochState, modify</span><span>
</span><span id="line-18"></span><span class="hs-comment">--   the ModelNewEpochState to reflect what we generated.</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier">GenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier">PlutusPurposeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier">plutusPurposeTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier">mkRedeemers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemersFromTags"><span class="hs-identifier">mkRedeemersFromTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkPlutusPurposePointer"><span class="hs-identifier">mkPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier">mkAlonzoPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkConwayPlutusPurposePointer"><span class="hs-identifier">mkConwayPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier">elementsT</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TODO move to a utilities module</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier">frequencyT</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TODO move to a utilities module</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier">positiveSingleDigitInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier">nonNegativeSingleDigitInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier">genSetElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier">genMapElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier">genMapElemWhere</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier">genRewardVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier">genPositiveVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier">genGenState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier">genGenEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier">genValidityInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier">getBlocksizeMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier">getCertificateMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier">getOldUtxoPercent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier">getRefInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier">getReserves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier">getSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier">getSlotDelta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier">getSpendInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier">getTreasury</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier">getUtxoChoicesMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier">getUtxoElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier">getUtxoTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier">getCollInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier">getNewPoolTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#viewGenState"><span class="hs-identifier">viewGenState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier">initialLedgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier">modifyModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier">runGenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ioGenRS"><span class="hs-identifier">ioGenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier">small</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier">genDatumWithHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier">genKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier">genScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier">genFreshKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier">genCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier">genFreshCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier">genFreshRegCred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier">genPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier">genPoolParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier">genRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier">genNewPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier">genRetirementHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier">initStableFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier">modifyGenStateInitialUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier">modifyGenStateInitialRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier">modifyModelCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier">modifyModelIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier">modifyModelUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier">modifyModelMutFee</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">RewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">Cardano.Ledger.Allegra.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">AllegraEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">Timelock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">RequireTimeExpire</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">RequireTimeStart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">IsValid</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Redeemers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier">EpochInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Network</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Testnet</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">inject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">Cardano.Ledger.Conway.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">ConwayPlutusPurpose</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyHashObj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">ScriptHashObj</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">StakeCredential</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyRole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">coerceKeyRole</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">hashKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Plutus.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Data</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">hashData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.PoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Core</span></a></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">CertState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">DState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">PState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RewardAccounts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">smartUTxOState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">totalObligation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">utxosGovStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">MultiSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RequireAllOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RequireAnyOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RequireMOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RequireSignature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.UMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UM</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier">Cardano.Slotting.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier">SlotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">join</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">when</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">zipWithM_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">Control.Monad.Trans.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">MonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">RWST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">ask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">asks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">gets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">modify</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-identifier">Control.SetAlgebra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-identifier">eval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-operator">(&#10755;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/data-default-class-0.1.2.0-cc61b3e1505bae222166941c5d7d95310a6fc64233e500cdf16191d60ef6520a/share/doc/html/src"><span class="hs-identifier">Data.Default.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/data-default-class-0.1.2.0-cc61b3e1505bae222166941c5d7d95310a6fc64233e500cdf16191d60ef6520a/share/doc/html/src"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/data-default-class-0.1.2.0-cc61b3e1505bae222166941c5d7d95310a6fc64233e500cdf16191d60ef6520a/share/doc/html/src"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier">SJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-identifier">Lens.Micro</span></a></span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-test-1.3.0.0/doc/html/cardano-ledger-alonzo-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Alonzo.Serialisation.Generators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-test-1.3.0.0/doc/html/cardano-ledger-babbage-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Babbage.Serialisation.Generators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Test.Cardano.Ledger.Core.KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Fields</span></a></span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysFalse"><span class="hs-identifier">alwaysFalse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysTrue"><span class="hs-identifier">alwaysTrue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#primaryLanguage"><span class="hs-identifier">primaryLanguage</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#protocolVersion"><span class="hs-identifier">protocolVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutFields"><span class="hs-identifier">txoutFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier">ModelNewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#genDelegsZero"><span class="hs-identifier">genDelegsZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#instantaneousRewardsZero"><span class="hs-identifier">instantaneousRewardsZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mKeyDeposits"><span class="hs-identifier">mKeyDeposits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mNewEpochStateZero"><span class="hs-identifier">mNewEpochStateZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDeposits"><span class="hs-identifier">mPoolDeposits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#pcModelNewEpochState"><span class="hs-identifier">pcModelNewEpochState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.PrettyCore</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#PDoc"><span class="hs-identifier">PDoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#PrettyA"><span class="hs-identifier">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCoin"><span class="hs-identifier">pcCoin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier">pcCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcIndividualPoolStake"><span class="hs-identifier">pcIndividualPoolStake</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier">pcKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcPoolParams"><span class="hs-identifier">pcPoolParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxIn"><span class="hs-identifier">pcTxIn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxOut"><span class="hs-identifier">pcTxOut</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier">ppInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier">ppMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppRecord"><span class="hs-identifier">ppRecord</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppSet"><span class="hs-identifier">ppSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppString"><span class="hs-identifier">ppString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppValidityInterval"><span class="hs-identifier">ppValidityInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Updaters.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Updaters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Updaters.html#defaultCostModels"><span class="hs-identifier">defaultCostModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Updaters.html#newPParams"><span class="hs-identifier">newPParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/tasty-quickcheck-0.11-f7b5b54ac4f7fedfbc5b4a059efd8763465a4d360842aa9a33a96c0eb490a2bb/share/doc/html/src"><span class="hs-identifier">Test.Tasty.QuickCheck</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">arbitrary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">choose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">chooseInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">elements</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">frequency</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier">generate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Constants that determine how big a GenState is generated.</span><span>
</span><span id="line-199"></span><span class="hs-keyword">data</span><span> </span><span id="GenSize"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-var">GenSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenSize"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-var">GenSize</span></a></span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="treasury"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var hs-var">treasury</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="reserves"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var hs-var">reserves</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="startSlot"><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var hs-var">startSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="slotDelta"><span class="annot"><span class="annottext">GenSize -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var hs-var">slotDelta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="blocksizeMax"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var hs-var">blocksizeMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="collInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var hs-var">collInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="spendInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var hs-var">spendInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="refInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var hs-var">refInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="utxoChoicesMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var hs-var">utxoChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="certificateMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var hs-var">certificateMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="withdrawalMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var hs-var">withdrawalMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="oldUtxoPercent"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var hs-var">oldUtxoPercent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-comment">-- between 0-100, 10 means pick an old UTxO 10% of the time</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="maxStablePools"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var hs-var">maxStablePools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621685086858"><span id="local-6989586621685086860"><span id="local-6989586621685086882"><span class="annot"><span class="annottext">Int -&gt; GenSize -&gt; ShowS
[GenSize] -&gt; ShowS
GenSize -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GenSize] -&gt; ShowS
$cshowList :: [GenSize] -&gt; ShowS
show :: GenSize -&gt; String
$cshow :: GenSize -&gt; String
showsPrec :: Int -&gt; GenSize -&gt; ShowS
$cshowsPrec :: Int -&gt; GenSize -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">data</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span> </span><span id="local-6989586621685087723"><span class="annot"><a href="#local-6989586621685087723"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gePParams"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087723"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="geSize"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var hs-var">geSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">data</span><span> </span><span id="GenState"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span></span><span> </span><span id="local-6989586621685087718"><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenState"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gsValidityInterval"><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var hs-var">gsValidityInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsKeys"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var hs-var">gsKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsScripts"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var hs-var">gsScripts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsPlutusScripts"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var hs-var">gsPlutusScripts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsDatums"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var hs-var">gsDatums</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsVI"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var hs-var">gsVI</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsModel"><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var hs-var">gsModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialUtxo"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var hs-var">gsInitialUtxo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialRewards"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var hs-var">gsInitialRewards</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialDelegations"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialDelegations"><span class="hs-identifier hs-var hs-var">gsInitialDelegations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialPoolParams"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var hs-var">gsInitialPoolParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialPoolDistr"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var hs-var">gsInitialPoolDistr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Stable fields are stable from initialization to the end of the generation process</span><span>
</span><span id="line-237"></span><span>    </span><span id="gsStablePools"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var hs-var">gsStablePools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsStableDelegators"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var hs-var">gsStableDelegators</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsAvoidCred"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var hs-var">gsAvoidCred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsAvoidKey"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var hs-var">gsAvoidKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsProof"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsProof"><span class="hs-identifier hs-var hs-var">gsProof</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsGenEnv"><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var hs-var">gsGenEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087718"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsSeedIdx"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsSeedIdx"><span class="hs-identifier hs-var hs-var">gsSeedIdx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621685087675"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-type">emptyGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087675"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087675"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087675"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087675"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-247"></span><span id="emptyGenState"><span class="annot"><span class="annottext">emptyGenState :: forall era. Reflect era =&gt; Proof era -&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var hs-var">emptyGenState</span></a></span></span><span> </span><span id="local-6989586621685086810"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086810"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086809"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086809"><span class="hs-identifier hs-var">genv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">forall era.
ValidityInterval
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
-&gt; Map (ScriptHash (EraCrypto era)) (Script era)
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
-&gt; Map (DataHash (EraCrypto era)) (Data era)
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
-&gt; ModelNewEpochState era
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Set (Credential 'Staking (EraCrypto era))
-&gt; Set (Credential 'Staking (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Proof era
-&gt; GenEnv era
-&gt; Int
-&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mNewEpochStateZero"><span class="hs-identifier hs-var">mNewEpochStateZero</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mPParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086809"><span class="hs-identifier hs-var">genv</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086810"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086809"><span class="hs-identifier hs-var">genv</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-268"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-pragma hs-type">emptyGenState</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/data-default-class-0.1.2.0-cc61b3e1505bae222166941c5d7d95310a6fc64233e500cdf16191d60ef6520a/share/doc/html/src"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621685086797"><span class="annot"><span class="annottext">def :: GenSize
</span><a href="#local-6989586621685086797"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">treasury :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reserves :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">startSlot :: Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slotDelta :: (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blocksizeMax :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">collInputsMax :: Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">5</span></span><span>
</span><span id="line-279"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oldUtxoPercent :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">spendInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">refInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxoChoicesMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certificateMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withdrawalMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxStablePools :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier hs-type">small</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-289"></span><span id="small"><span class="annot"><span class="annottext">small :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier hs-var hs-var">small</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">treasury :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reserves :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">startSlot :: Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slotDelta :: (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blocksizeMax :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">collInputsMax :: Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oldUtxoPercent :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">spendInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">refInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxoChoicesMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certificateMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withdrawalMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxStablePools :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-keyword">data</span><span> </span><span id="PlutusPurposeTag"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-var">PlutusPurposeTag</span></a></span></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Spending"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Minting"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Minting"><span class="hs-identifier hs-var">Minting</span></a></span></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Certifying"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Rewarding"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Voting"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Voting"><span class="hs-identifier hs-var">Voting</span></a></span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Proposing"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#Proposing"><span class="hs-identifier hs-var">Proposing</span></a></span></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621685086787"><span id="local-6989586621685086789"><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c/= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
== :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c== :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086767"><span id="local-6989586621685086769"><span id="local-6989586621685086772"><span id="local-6989586621685086775"><span id="local-6989586621685086778"><span id="local-6989586621685086780"><span id="local-6989586621685086782"><span class="annot"><span class="annottext">Eq PlutusPurposeTag
PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Ordering
PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; PlutusPurposeTag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; PlutusPurposeTag
$cmin :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; PlutusPurposeTag
max :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; PlutusPurposeTag
$cmax :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; PlutusPurposeTag
&gt;= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c&gt;= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
&gt; :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c&gt; :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
&lt;= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c&lt;= :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
&lt; :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
$c&lt; :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
compare :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Ordering
$ccompare :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086760"><span id="local-6989586621685086762"><span id="local-6989586621685086764"><span class="annot"><span class="annottext">Int -&gt; PlutusPurposeTag -&gt; ShowS
[PlutusPurposeTag] -&gt; ShowS
PlutusPurposeTag -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PlutusPurposeTag] -&gt; ShowS
$cshowList :: [PlutusPurposeTag] -&gt; ShowS
show :: PlutusPurposeTag -&gt; String
$cshow :: PlutusPurposeTag -&gt; String
showsPrec :: Int -&gt; PlutusPurposeTag -&gt; ShowS
$cshowsPrec :: Int -&gt; PlutusPurposeTag -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086721"><span id="local-6989586621685086723"><span id="local-6989586621685086727"><span id="local-6989586621685086731"><span id="local-6989586621685086733"><span id="local-6989586621685086745"><span id="local-6989586621685086751"><span id="local-6989586621685086758"><span class="annot"><span class="annottext">Int -&gt; PlutusPurposeTag
PlutusPurposeTag -&gt; Int
PlutusPurposeTag -&gt; [PlutusPurposeTag]
PlutusPurposeTag -&gt; PlutusPurposeTag
PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
PlutusPurposeTag
-&gt; PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: PlutusPurposeTag
-&gt; PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
$cenumFromThenTo :: PlutusPurposeTag
-&gt; PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
enumFromTo :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
$cenumFromTo :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
enumFromThen :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
$cenumFromThen :: PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; [PlutusPurposeTag]
enumFrom :: PlutusPurposeTag -&gt; [PlutusPurposeTag]
$cenumFrom :: PlutusPurposeTag -&gt; [PlutusPurposeTag]
fromEnum :: PlutusPurposeTag -&gt; Int
$cfromEnum :: PlutusPurposeTag -&gt; Int
toEnum :: Int -&gt; PlutusPurposeTag
$ctoEnum :: Int -&gt; PlutusPurposeTag
pred :: PlutusPurposeTag -&gt; PlutusPurposeTag
$cpred :: PlutusPurposeTag -&gt; PlutusPurposeTag
succ :: PlutusPurposeTag -&gt; PlutusPurposeTag
$csucc :: PlutusPurposeTag -&gt; PlutusPurposeTag
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086716"><span id="local-6989586621685086718"><span class="annot"><span class="annottext">PlutusPurposeTag
forall a. a -&gt; a -&gt; Bounded a
maxBound :: PlutusPurposeTag
$cmaxBound :: PlutusPurposeTag
minBound :: PlutusPurposeTag
$cminBound :: PlutusPurposeTag
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span id="local-6989586621685087646"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier hs-type">plutusPurposeTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087646"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-316"></span><span id="plutusPurposeTags"><span class="annot"><span class="annottext">plutusPurposeTags :: forall era. Proof era -&gt; [PlutusPurposeTag]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier hs-var hs-var">plutusPurposeTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Proposing"><span class="hs-identifier hs-var">Proposing</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier hs-type">mkRedeemers</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087637"><span class="annot"><a href="#local-6989586621685087637"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087637"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusPurpose</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087637"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087637"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087637"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-329"></span><span id="mkRedeemers"><span class="annot"><span class="annottext">mkRedeemers :: forall era.
Proof era
-&gt; [(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier hs-var hs-var">mkRedeemers</span></a></span></span><span> </span><span id="local-6989586621685086698"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086698"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086697"><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086697"><span class="hs-identifier hs-var">redeemerMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- Pattern match on proof is needed in order to avoid leacking Ord constraint.</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086698"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
AlonzoEraScript era =&gt;
Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086697"><span class="hs-identifier hs-var">redeemerMap</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
AlonzoEraScript era =&gt;
Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086697"><span class="hs-identifier hs-var">redeemerMap</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
AlonzoEraScript era =&gt;
Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086697"><span class="hs-identifier hs-var">redeemerMap</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemersFromTags"><span class="hs-identifier hs-type">mkRedeemersFromTags</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087614"><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-344"></span><span id="mkRedeemersFromTags"><span class="annot"><span class="annottext">mkRedeemersFromTags :: forall era.
Proof era
-&gt; [((PlutusPurposeTag, Word32), (Data era, ExUnits))]
-&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemersFromTags"><span class="hs-identifier hs-var hs-var">mkRedeemersFromTags</span></a></span></span><span> </span><span id="local-6989586621685086663"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086662"><span class="annot"><span class="annottext">[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
</span><a href="#local-6989586621685086662"><span class="hs-identifier hs-var">redeemerPointers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No Redeemers&quot;</span></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; [(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier hs-var">mkRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086651"><span class="hs-identifier hs-var">redeemerAssocs</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; [(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier hs-var">mkRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086651"><span class="hs-identifier hs-var">redeemerAssocs</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; [(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkRedeemers"><span class="hs-identifier hs-var">mkRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086651"><span class="hs-identifier hs-var">redeemerAssocs</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><a href="#local-6989586621685086651"><span class="hs-identifier hs-type">redeemerAssocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusPurpose</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087614"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621685086651"><span class="annot"><span class="annottext">redeemerAssocs :: [(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621685086651"><span class="hs-identifier hs-var hs-var">redeemerAssocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Proof era -&gt; PlutusPurposeTag -&gt; Word32 -&gt; PlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkPlutusPurposePointer"><span class="hs-identifier hs-var">mkPlutusPurposePointer</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086663"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086648"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086647"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Data era, ExUnits)
</span><a href="#local-6989586621685086646"><span class="hs-identifier hs-var">redeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621685086648"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086648"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086647"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086647"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086646"><span class="annot"><span class="annottext">(Data era, ExUnits)
</span><a href="#local-6989586621685086646"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
</span><a href="#local-6989586621685086662"><span class="hs-identifier hs-var">redeemerPointers</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span id="local-6989586621685087612"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkPlutusPurposePointer"><span class="hs-identifier hs-type">mkPlutusPurposePointer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087612"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusPurpose</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087612"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-364"></span><span id="mkPlutusPurposePointer"><span class="annot"><span class="annottext">mkPlutusPurposePointer :: forall era.
Proof era -&gt; PlutusPurposeTag -&gt; Word32 -&gt; PlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkPlutusPurposePointer"><span class="hs-identifier hs-var hs-var">mkPlutusPurposePointer</span></a></span></span><span> </span><span id="local-6989586621685086645"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086645"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086644"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086644"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621685086643"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086643"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086645"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No PlutusPurpose&quot;</span></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No PlutusPurpose&quot;</span></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No PlutusPurpose&quot;</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
PlutusPurposeTag -&gt; Word32 -&gt; AlonzoPlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier hs-var">mkAlonzoPlutusPurposePointer</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086644"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086643"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
PlutusPurposeTag -&gt; Word32 -&gt; AlonzoPlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier hs-var">mkAlonzoPlutusPurposePointer</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086644"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086643"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
PlutusPurposeTag -&gt; Word32 -&gt; ConwayPlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkConwayPlutusPurposePointer"><span class="hs-identifier hs-var">mkConwayPlutusPurposePointer</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086644"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086643"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier hs-type">mkAlonzoPlutusPurposePointer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087608"><span class="annot"><a href="#local-6989586621685087608"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087608"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AlonzoPlutusPurpose</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087608"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-379"></span><span id="mkAlonzoPlutusPurposePointer"><span class="annot"><span class="annottext">mkAlonzoPlutusPurposePointer :: forall era.
Era era =&gt;
PlutusPurposeTag -&gt; Word32 -&gt; AlonzoPlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier hs-var hs-var">mkAlonzoPlutusPurposePointer</span></a></span></span><span> </span><span id="local-6989586621685086616"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086616"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621685086615"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086615"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086616"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (TxIn (EraCrypto era)) -&gt; AlonzoPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AlonzoSpending</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086615"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Minting"><span class="hs-identifier hs-var">Minting</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (PolicyID (EraCrypto era)) -&gt; AlonzoPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AlonzoMinting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086615"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (TxCert era) -&gt; AlonzoPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AlonzoCertifying</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086615"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (RewardAccount (EraCrypto era))
-&gt; AlonzoPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AlonzoRewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086615"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported tag: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086616"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in era &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; String
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087608"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621685087606"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkConwayPlutusPurposePointer"><span class="hs-identifier hs-type">mkConwayPlutusPurposePointer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayPlutusPurpose</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087606"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-388"></span><span id="mkConwayPlutusPurposePointer"><span class="annot"><span class="annottext">mkConwayPlutusPurposePointer :: forall era.
PlutusPurposeTag -&gt; Word32 -&gt; ConwayPlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkConwayPlutusPurposePointer"><span class="hs-identifier hs-var hs-var">mkConwayPlutusPurposePointer</span></a></span></span><span> </span><span id="local-6989586621685086607"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086607"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621685086606"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685086607"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (TxIn (EraCrypto era)) -&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwaySpending</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Minting"><span class="hs-identifier hs-var">Minting</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (PolicyID (EraCrypto era)) -&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwayMinting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (TxCert era) -&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwayCertifying</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (RewardAccount (EraCrypto era))
-&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwayRewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Voting"><span class="hs-identifier hs-var">Voting</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (Voter (EraCrypto era)) -&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwayVoting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Proposing"><span class="hs-identifier hs-var">Proposing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) era.
f Word32 (ProposalProcedure era) -&gt; ConwayPlutusPurpose f era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.17.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-var">ConwayProposing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix it. ix -&gt; AsIx ix it
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">AsIx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621685086606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- Accessing information</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621685087590"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-type">getSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087590"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span></span><span>
</span><span id="line-401"></span><span id="getSlot"><span class="annot"><span class="annottext">getSlot :: forall era. GenState era -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-var hs-var">getSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621685087585"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-type">getSlotDelta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087585"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-404"></span><span id="getSlotDelta"><span class="annot"><span class="annottext">getSlotDelta :: forall era. GenState era -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-var hs-var">getSlotDelta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621685087583"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-type">getBlocksizeMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087583"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span>
</span><span id="line-407"></span><span id="getBlocksizeMax"><span class="annot"><span class="annottext">getBlocksizeMax :: forall era. GenState era -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-var hs-var">getBlocksizeMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621685086597"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-type">getSpendInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086597"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-410"></span><span id="getSpendInputsMax"><span class="annot"><span class="annottext">getSpendInputsMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-var hs-var">getSpendInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span id="local-6989586621685086596"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-type">getRefInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086596"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-413"></span><span id="getRefInputsMax"><span class="annot"><span class="annottext">getRefInputsMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-var hs-var">getRefInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621685086595"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-type">getCertificateMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086595"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-416"></span><span id="getCertificateMax"><span class="annot"><span class="annottext">getCertificateMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-var hs-var">getCertificateMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span id="local-6989586621685086594"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-type">getUtxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086594"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-419"></span><span id="getUtxoChoicesMax"><span class="annot"><span class="annottext">getUtxoChoicesMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-var hs-var">getUtxoChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span id="local-6989586621685087577"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier hs-type">getCollInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087577"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span></span><span>
</span><span id="line-422"></span><span id="getCollInputsMax"><span class="annot"><span class="annottext">getCollInputsMax :: forall era. GenState era -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier hs-var hs-var">getCollInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span id="local-6989586621685086593"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-type">getOldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086593"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-425"></span><span id="getOldUtxoPercent"><span class="annot"><span class="annottext">getOldUtxoPercent :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-var hs-var">getOldUtxoPercent</span></a></span></span><span> </span><span id="local-6989586621685086588"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086588"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086588"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span id="local-6989586621685087574"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-type">getTreasury</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087574"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-428"></span><span id="getTreasury"><span class="annot"><span class="annottext">getTreasury :: forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-var hs-var">getTreasury</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621685086584"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-type">getReserves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086584"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-431"></span><span id="getReserves"><span class="annot"><span class="annottext">getReserves :: forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-var hs-var">getReserves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- ========================================================</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- Modifying fields of the GenState as side effects in GenRS</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span id="local-6989586621685087571"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-type">setVi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087571"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-437"></span><span id="setVi"><span class="annot"><span class="annottext">setVi :: forall era. GenState era -&gt; ValidityInterval -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-var hs-var">setVi</span></a></span></span><span> </span><span id="local-6989586621685086582"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086582"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621685086581"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685086581"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086582"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsValidityInterval :: ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685086581"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-438"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-pragma hs-type">setVi</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span id="local-6989586621685087569"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-type">modifyGenStateKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087569"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087569"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087569"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Witness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087569"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087569"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-445"></span><span id="modifyGenStateKeys"><span class="annot"><span class="annottext">modifyGenStateKeys :: forall era.
(Map
   (KeyHash 'Witness (EraCrypto era))
   (KeyPair 'Witness (EraCrypto era))
 -&gt; Map
      (KeyHash 'Witness (EraCrypto era))
      (KeyPair 'Witness (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-var hs-var">modifyGenStateKeys</span></a></span></span><span> </span><span id="local-6989586621685086576"><span class="annot"><span class="annottext">Map
  (KeyHash 'Witness (EraCrypto era))
  (KeyPair 'Witness (EraCrypto era))
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="#local-6989586621685086576"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086575"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086575"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086575"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsKeys :: Map
  (KeyHash 'Witness (EraCrypto era))
  (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'Witness (EraCrypto era))
  (KeyPair 'Witness (EraCrypto era))
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="#local-6989586621685086576"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086575"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span id="local-6989586621685087561"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-type">modifyGenStateDatums</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087561"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087561"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087561"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087561"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087561"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-450"></span><span id="modifyGenStateDatums"><span class="annot"><span class="annottext">modifyGenStateDatums :: forall era.
(Map (DataHash (EraCrypto era)) (Data era)
 -&gt; Map (DataHash (EraCrypto era)) (Data era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-var hs-var">modifyGenStateDatums</span></a></span></span><span> </span><span id="local-6989586621685086571"><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
-&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621685086571"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086570"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086570"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086570"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsDatums :: Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
-&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621685086571"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086570"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span id="local-6989586621685087559"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-type">modifyGenStateVI</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087559"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087559"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087559"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-457"></span><span id="modifyGenStateVI"><span class="annot"><span class="annottext">modifyGenStateVI :: forall era.
(Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
 -&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era))))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-var hs-var">modifyGenStateVI</span></a></span></span><span> </span><span id="local-6989586621685086566"><span class="annot"><span class="annottext">Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="#local-6989586621685086566"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086565"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086565"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086565"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsVI :: Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="#local-6989586621685086566"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086565"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span id="local-6989586621685087557"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-type">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087557"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087557"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087557"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-464"></span><span id="modifyGenStateInitialRewards"><span class="annot"><span class="annottext">modifyGenStateInitialRewards :: forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialRewards</span></a></span></span><span> </span><span id="local-6989586621685086562"><span class="annot"><span class="annottext">Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="#local-6989586621685086562"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621685086561"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086561"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086561"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsInitialRewards :: Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="#local-6989586621685086562"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086561"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span id="local-6989586621685087555"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-type">modifyGenStateInitialUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087555"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087555"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087555"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087555"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087555"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-471"></span><span id="modifyGenStateInitialUtxo"><span class="annot"><span class="annottext">modifyGenStateInitialUtxo :: forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialUtxo</span></a></span></span><span> </span><span id="local-6989586621685086558"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086558"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621685086557"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086557"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086557"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsInitialUtxo :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086558"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086557"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621685087553"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-type">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087553"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087553"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087553"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-478"></span><span id="modifyGenStateAvoidCred"><span class="annot"><span class="annottext">modifyGenStateAvoidCred :: forall era.
(Set (Credential 'Staking (EraCrypto era))
 -&gt; Set (Credential 'Staking (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var hs-var">modifyGenStateAvoidCred</span></a></span></span><span> </span><span id="local-6989586621685086553"><span class="annot"><span class="annottext">Set (Credential 'Staking (EraCrypto era))
-&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="#local-6989586621685086553"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086552"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086552"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086552"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsAvoidCred :: Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking (EraCrypto era))
-&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="#local-6989586621685086553"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086552"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span id="local-6989586621685087551"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-type">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087551"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087551"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087551"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-483"></span><span id="modifyGenStateAvoidKey"><span class="annot"><span class="annottext">modifyGenStateAvoidKey :: forall era.
(Set (KeyHash 'StakePool (EraCrypto era))
 -&gt; Set (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var hs-var">modifyGenStateAvoidKey</span></a></span></span><span> </span><span id="local-6989586621685086548"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086548"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086547"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086547"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086547"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsAvoidKey :: Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086548"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086547"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span id="local-6989586621685086546"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-type">modifyGenStateStablePools</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086546"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-488"></span><span id="modifyGenStateStablePools"><span class="annot"><span class="annottext">modifyGenStateStablePools :: forall era.
(Set (KeyHash 'StakePool (EraCrypto era))
 -&gt; Set (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-var hs-var">modifyGenStateStablePools</span></a></span></span><span> </span><span id="local-6989586621685086542"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086542"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086541"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086541"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086541"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsStablePools :: Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
-&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086542"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086541"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span id="local-6989586621685087548"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-type">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087548"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087548"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087548"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087548"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087548"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-495"></span><span id="modifyGenStateInitialPoolParams"><span class="annot"><span class="annottext">modifyGenStateInitialPoolParams :: forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialPoolParams</span></a></span></span><span> </span><span id="local-6989586621685086537"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086537"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086536"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086536"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086536"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsInitialPoolParams :: Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086537"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086536"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span id="local-6989586621685087546"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-type">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087546"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087546"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-502"></span><span id="modifyGenStateInitialPoolDistr"><span class="annot"><span class="annottext">modifyGenStateInitialPoolDistr :: forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialPoolDistr</span></a></span></span><span> </span><span id="local-6989586621685086532"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="#local-6989586621685086532"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086531"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086531"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086531"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsInitialPoolDistr :: Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="#local-6989586621685086532"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086531"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621685086530"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-type">modifyGenStateStableDelegators</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086530"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086530"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086530"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-507"></span><span id="modifyGenStateStableDelegators"><span class="annot"><span class="annottext">modifyGenStateStableDelegators :: forall era.
(Set (Credential 'Staking (EraCrypto era))
 -&gt; Set (Credential 'Staking (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-var hs-var">modifyGenStateStableDelegators</span></a></span></span><span> </span><span id="local-6989586621685086526"><span class="annot"><span class="annottext">Set (StakeCredential (EraCrypto era))
-&gt; Set (StakeCredential (EraCrypto era))
</span><a href="#local-6989586621685086526"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086525"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086525"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086525"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsStableDelegators :: Set (StakeCredential (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (StakeCredential (EraCrypto era))
-&gt; Set (StakeCredential (EraCrypto era))
</span><a href="#local-6989586621685086526"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086525"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span id="local-6989586621685087543"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialDelegations"><span class="hs-identifier hs-type">modifyGenStateInitialDelegations</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087543"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087543"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087543"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087543"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087543"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-514"></span><span id="modifyGenStateInitialDelegations"><span class="annot"><span class="annottext">modifyGenStateInitialDelegations :: forall era.
(Map
   (Credential 'Staking (EraCrypto era))
   (KeyHash 'StakePool (EraCrypto era))
 -&gt; Map
      (Credential 'Staking (EraCrypto era))
      (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialDelegations"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialDelegations</span></a></span></span><span> </span><span id="local-6989586621685086521"><span class="annot"><span class="annottext">Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086520"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086520"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086520"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsInitialDelegations :: Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialDelegations"><span class="hs-identifier hs-var">gsInitialDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialDelegations"><span class="hs-identifier hs-var">gsInitialDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086520"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span id="local-6989586621685087541"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-type">modifyGenStateScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087541"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087541"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087541"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087541"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087541"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-521"></span><span id="modifyGenStateScripts"><span class="annot"><span class="annottext">modifyGenStateScripts :: forall era.
(Map (ScriptHash (EraCrypto era)) (Script era)
 -&gt; Map (ScriptHash (EraCrypto era)) (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var hs-var">modifyGenStateScripts</span></a></span></span><span> </span><span id="local-6989586621685086516"><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
-&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621685086516"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621685086515"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086515"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086515"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsScripts :: Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
-&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621685086516"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086515"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span id="local-6989586621685087539"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-type">modifyPlutusScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087539"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087539"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087539"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087539"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087539"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-529"></span><span id="modifyPlutusScripts"><span class="annot"><span class="annottext">modifyPlutusScripts :: forall era.
(Map
   (ScriptHash (EraCrypto era), PlutusPurposeTag)
   (IsValid, Script era)
 -&gt; Map
      (ScriptHash (EraCrypto era), PlutusPurposeTag)
      (IsValid, Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-var hs-var">modifyPlutusScripts</span></a></span></span><span> </span><span id="local-6989586621685086511"><span class="annot"><span class="annottext">Map
  (ScriptHash (EraCrypto era), PlutusPurposeTag)
  (IsValid, Script era)
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="#local-6989586621685086511"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086510"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086510"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086510"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsPlutusScripts :: Map
  (ScriptHash (EraCrypto era), PlutusPurposeTag)
  (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (ScriptHash (EraCrypto era), PlutusPurposeTag)
  (IsValid, Script era)
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="#local-6989586621685086511"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086510"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- ===================================================</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- functions that modify individual fields of ModelState</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span id="local-6989586621685087537"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-type">modifyModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087537"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087537"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087537"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-535"></span><span id="modifyModel"><span class="annot"><span class="annottext">modifyModel :: forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var hs-var">modifyModel</span></a></span></span><span> </span><span id="local-6989586621685086507"><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; ModelNewEpochState era
</span><a href="#local-6989586621685086507"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086506"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086506"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086506"><span class="hs-identifier hs-var">gstate</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsModel :: ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; ModelNewEpochState era
</span><a href="#local-6989586621685086507"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086506"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span id="local-6989586621685086505"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDelegations"><span class="hs-identifier hs-type">modifyModelDelegations</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086505"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086505"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-542"></span><span id="modifyModelDelegations"><span class="annot"><span class="annottext">modifyModelDelegations :: forall era.
(Map
   (Credential 'Staking (EraCrypto era))
   (KeyHash 'StakePool (EraCrypto era))
 -&gt; Map
      (Credential 'Staking (EraCrypto era))
      (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDelegations"><span class="hs-identifier hs-var hs-var">modifyModelDelegations</span></a></span></span><span> </span><span id="local-6989586621685086503"><span class="annot"><span class="annottext">Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086503"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086502"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086502"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086502"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mDelegations :: Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDelegations"><span class="hs-identifier hs-var">mDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking (EraCrypto era))
  (KeyHash 'StakePool (EraCrypto era))
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685086503"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDelegations"><span class="hs-identifier hs-var">mDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086502"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span id="local-6989586621685086500"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelRewards"><span class="hs-identifier hs-type">modifyModelRewards</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086500"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086500"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086500"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-549"></span><span id="modifyModelRewards"><span class="annot"><span class="annottext">modifyModelRewards :: forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelRewards"><span class="hs-identifier hs-var hs-var">modifyModelRewards</span></a></span></span><span> </span><span id="local-6989586621685086498"><span class="annot"><span class="annottext">Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="#local-6989586621685086498"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086497"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086497"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086497"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mRewards :: Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mRewards"><span class="hs-identifier hs-var">mRewards</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="#local-6989586621685086498"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mRewards"><span class="hs-identifier hs-var">mRewards</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086497"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span id="local-6989586621685087532"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-type">modifyModelDeposited</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087532"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-552"></span><span id="modifyModelDeposited"><span class="annot"><span class="annottext">modifyModelDeposited :: forall era. (Coin -&gt; Coin) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-var hs-var">modifyModelDeposited</span></a></span></span><span> </span><span id="local-6989586621685086494"><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621685086494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086493"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086493"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086493"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mDeposited :: Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDeposited"><span class="hs-identifier hs-var">mDeposited</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621685086494"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. ModelNewEpochState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDeposited"><span class="hs-identifier hs-var">mDeposited</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086493"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span id="local-6989586621685087530"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyKeyDeposits"><span class="hs-identifier hs-type">modifyKeyDeposits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087530"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087530"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-555"></span><span id="modifyKeyDeposits"><span class="annot"><span class="annottext">modifyKeyDeposits :: forall era.
Credential 'Staking (EraCrypto era) -&gt; Coin -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyKeyDeposits"><span class="hs-identifier hs-var hs-var">modifyKeyDeposits</span></a></span></span><span> </span><span id="local-6989586621685086488"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685086488"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621685086487"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086487"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086486"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086486"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086486"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mKeyDeposits :: Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mKeyDeposits"><span class="hs-identifier hs-var">mKeyDeposits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685086488"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086487"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mKeyDeposits"><span class="hs-identifier hs-var">mKeyDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086486"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span id="local-6989586621685086484"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolParams"><span class="hs-identifier hs-type">modifyModelPoolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086484"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086484"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086484"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086484"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086484"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-563"></span><span id="modifyModelPoolParams"><span class="annot"><span class="annottext">modifyModelPoolParams :: forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolParams"><span class="hs-identifier hs-var hs-var">modifyModelPoolParams</span></a></span></span><span> </span><span id="local-6989586621685086482"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086482"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086481"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086481"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086481"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mPoolParams :: Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086482"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086481"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span id="local-6989586621685086479"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-type">modifyModelPoolDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086479"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-570"></span><span id="modifyModelPoolDistr"><span class="annot"><span class="annottext">modifyModelPoolDistr :: forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-var hs-var">modifyModelPoolDistr</span></a></span></span><span> </span><span id="local-6989586621685086477"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="#local-6989586621685086477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086476"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086476"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086476"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mPoolDistr :: Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDistr"><span class="hs-identifier hs-var">mPoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era))
  (IndividualPoolStake (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="#local-6989586621685086477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDistr"><span class="hs-identifier hs-var">mPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086476"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span id="local-6989586621685087522"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelKeyDeposits"><span class="hs-identifier hs-type">modifyModelKeyDeposits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087522"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087522"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-573"></span><span id="modifyModelKeyDeposits"><span class="annot"><span class="annottext">modifyModelKeyDeposits :: forall era.
KeyHash 'StakePool (EraCrypto era) -&gt; Coin -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelKeyDeposits"><span class="hs-identifier hs-var hs-var">modifyModelKeyDeposits</span></a></span></span><span> </span><span id="local-6989586621685086472"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685086472"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span id="local-6989586621685086471"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086471"><span class="hs-identifier hs-var">pooldeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086470"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086470"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086470"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mPoolDeposits :: Map (KeyHash 'StakePool (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDeposits"><span class="hs-identifier hs-var">mPoolDeposits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685086472"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086471"><span class="hs-identifier hs-var">pooldeposit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (KeyHash 'StakePool (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDeposits"><span class="hs-identifier hs-var">mPoolDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086470"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span id="local-6989586621685087520"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-type">modifyModelCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087520"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-577"></span><span id="modifyModelCount"><span class="annot"><span class="annottext">modifyModelCount :: forall era. (Int -&gt; Int) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-var hs-var">modifyModelCount</span></a></span></span><span> </span><span id="local-6989586621685086469"><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621685086469"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086468"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086468"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086468"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mCount :: Int
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621685086469"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. ModelNewEpochState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086468"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span id="local-6989586621685087518"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-type">modifyModelIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087518"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087518"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-581"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087518"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-582"></span><span id="modifyModelIndex"><span class="annot"><span class="annottext">modifyModelIndex :: forall era.
(Map Int (TxId (EraCrypto era)) -&gt; Map Int (TxId (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-var hs-var">modifyModelIndex</span></a></span></span><span> </span><span id="local-6989586621685086466"><span class="annot"><span class="annottext">Map Int (TxId (EraCrypto era)) -&gt; Map Int (TxId (EraCrypto era))
</span><a href="#local-6989586621685086466"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086465"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086465"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086465"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mIndex :: Map Int (TxId (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mIndex"><span class="hs-identifier hs-var">mIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Int (TxId (EraCrypto era)) -&gt; Map Int (TxId (EraCrypto era))
</span><a href="#local-6989586621685086466"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era -&gt; Map Int (TxId (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mIndex"><span class="hs-identifier hs-var">mIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086465"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span id="local-6989586621685086463"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-type">modifyModelUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086463"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086463"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086463"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086463"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086463"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-587"></span><span id="modifyModelUTxO"><span class="annot"><span class="annottext">modifyModelUTxO :: forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-var hs-var">modifyModelUTxO</span></a></span></span><span> </span><span id="local-6989586621685086462"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086462"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086461"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086461"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086461"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mUTxO :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086462"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086461"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span id="local-6989586621685086459"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-type">modifyModelMutFee</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086459"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086459"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086459"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086459"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-593"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086459"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-594"></span><span id="modifyModelMutFee"><span class="annot"><span class="annottext">modifyModelMutFee :: forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-var hs-var">modifyModelMutFee</span></a></span></span><span> </span><span id="local-6989586621685086458"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086458"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685086457"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086457"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086457"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mMutFee :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mMutFee"><span class="hs-identifier hs-var">mMutFee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086458"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mMutFee"><span class="hs-identifier hs-var">mMutFee</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621685086457"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- The Monad</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">type</span><span> </span><span id="GenRS"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-var">GenRS</span></a></span></span><span> </span><span id="local-6989586621685086455"><span class="annot"><a href="#local-6989586621685086455"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">RWST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086455"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086455"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span id="local-6989586621685087512"><span id="local-6989586621685087513"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-type">genMapElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087513"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087513"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621685087512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-602"></span><span id="genMapElem"><span class="annot"><span class="annottext">genMapElem :: forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var hs-var">genMapElem</span></a></span></span><span> </span><span id="local-6989586621685086444"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086444"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086443"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-605"></span><span>      </span><span id="local-6989586621685086442"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086442"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086443"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.elemAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086442"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086444"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621685086443"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621685086443"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086444"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span id="local-6989586621685087501"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-type">genSetElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087501"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-611"></span><span id="genSetElem"><span class="annot"><span class="annottext">genSetElem :: forall a. Set a -&gt; Gen (Maybe a)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-var hs-var">genSetElem</span></a></span></span><span> </span><span id="local-6989586621685086430"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621685086430"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086429"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-614"></span><span>      </span><span id="local-6989586621685086428"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086428"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086429"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Set a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.elemAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086428"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621685086430"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-617"></span><span>    </span><span id="local-6989586621685086429"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621685086429"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621685086430"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-comment">-- | Use up to 'tries' attempts to choose a random (k,a) pair from 'm', that meets predicate 'p'</span><span>
</span><span id="line-620"></span><span id="local-6989586621685087496"><span id="local-6989586621685087497"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-type">genMapElemWhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087497"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087497"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621685087496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087497"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621685087496"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-621"></span><span id="genMapElemWhere"><span class="annot"><span class="annottext">genMapElemWhere :: forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var hs-var">genMapElemWhere</span></a></span></span><span> </span><span id="local-6989586621685086411"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086411"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621685086410"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086410"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span id="local-6989586621685086409"><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621685086409"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086410"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086407"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>      </span><span id="local-6989586621685086406"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086406"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086407"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621685086405"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621685086405"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086404"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086404"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.elemAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086406"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086411"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-627"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621685086409"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621685086405"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086404"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-628"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621685086405"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086404"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086411"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685086410"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621685086409"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621685086407"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621685086407"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621685086411"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span id="local-6989586621685087491"><span id="local-6989586621685087493"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-type">elementsT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087493"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087493"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621685087493"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087491"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621685087493"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087491"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-634"></span><span id="elementsT"><span class="annot"><span class="annottext">elementsT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var hs-var">elementsT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">elements</span></a></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span id="local-6989586621685087481"><span id="local-6989586621685087482"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-type">frequencyT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087482"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087482"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621685087482"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621685087482"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087481"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-637"></span><span id="frequencyT"><span class="annot"><span class="annottext">frequencyT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var hs-var">frequencyT</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;frequencyT called with empty list&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span id="local-6989586621685086384"><span class="annot"><span class="annottext">[(Int, t Gen b)]
</span><a href="#local-6989586621685086384"><span class="hs-identifier hs-var">choices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, t Gen b)]
</span><a href="#local-6989586621685086384"><span class="hs-identifier hs-var">choices</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | Gen a positive single digit Int, on a skewed distribution that</span><span>
</span><span id="line-641"></span><span class="hs-comment">--   favors 2,3,4,5 but occasionally gets others</span><span>
</span><span id="line-642"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-type">positiveSingleDigitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-643"></span><span id="positiveSingleDigitInt"><span class="annot"><span class="annottext">positiveSingleDigitInt :: Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var hs-var">positiveSingleDigitInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-644"></span><span>  </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {a} {a}. Applicative f =&gt; (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621685086382"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621685086382"><span class="annot"><span class="annottext">f :: (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621685086382"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621685086379"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086379"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086378"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086378"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086379"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086378"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | Gen a non-negative single digit Int, on a skewed distribution that</span><span>
</span><span id="line-649"></span><span class="hs-comment">--   favors 2,3,4,5 but occasionally gets others</span><span>
</span><span id="line-650"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-type">nonNegativeSingleDigitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-651"></span><span id="nonNegativeSingleDigitInt"><span class="annot"><span class="annottext">nonNegativeSingleDigitInt :: Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var hs-var">nonNegativeSingleDigitInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-652"></span><span>  </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {a} {a}. Applicative f =&gt; (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621685086377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621685086377"><span class="annot"><span class="annottext">f :: (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621685086377"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621685086374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086374"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086373"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086373"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086374"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086373"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span class="hs-comment">-- | Generate a non-zero value</span><span>
</span><span id="line-657"></span><span id="local-6989586621685087465"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-type">genPositiveVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087465"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087465"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-658"></span><span id="genPositiveVal"><span class="annot"><span class="annottext">genPositiveVal :: forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var hs-var">genPositiveVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t s. Inject t s =&gt; t -&gt; s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Positive a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">getPositive</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- | Generate a value (which is occaisionally 0) useful in generating Rewards, where we need a</span><span>
</span><span id="line-661"></span><span class="hs-comment">--   few 0's, because we cannot generate a DeReg certificates, without a 0 Reg value.</span><span>
</span><span id="line-662"></span><span class="hs-comment">--   Also used when generating the CollReturn, where an occasional 0 would be nice</span><span>
</span><span id="line-663"></span><span id="local-6989586621685086358"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-type">genRewardVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086358"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086358"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-664"></span><span id="genRewardVal"><span class="annot"><span class="annottext">genRewardVal :: forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-var hs-var">genRewardVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">97</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Test if the Payment part of the Address in the TxOut</span><span>
</span><span id="line-667"></span><span class="hs-comment">--   is valid in the current ValidityInterval. Using the simple rule allowing</span><span>
</span><span id="line-668"></span><span class="hs-comment">--   only (Key or Plutus or MutiSig) locking. Disallowing all Timelock scripts</span><span>
</span><span id="line-669"></span><span id="local-6989586621685087448"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#validTxOut"><span class="hs-identifier hs-type">validTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087448"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-671"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087448"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087448"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087448"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-673"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087448"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-675"></span><span id="validTxOut"><span class="annot"><span class="annottext">validTxOut :: forall era.
Proof era
-&gt; Map (ScriptHash (EraCrypto era)) (Script era)
-&gt; TxIn (EraCrypto era)
-&gt; TxOut era
-&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#validTxOut"><span class="hs-identifier hs-var hs-var">validTxOut</span></a></span></span><span> </span><span id="local-6989586621685086343"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086343"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086342"><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621685086342"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621685086341"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621685086341"><span class="hs-identifier hs-var">_txin</span></a></span></span><span> </span><span id="local-6989586621685086340"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621685086340"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; TxOut era -&gt; (Addr (EraCrypto era), Value era, [TxOutField era])
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutFields"><span class="hs-identifier hs-var">txoutFields</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086343"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621685086340"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621685086338"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685086338"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086343"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685086338"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621685086342"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript (ConwayEra StandardCrypto)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript (BabbageEra StandardCrypto)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript (AlonzoEra StandardCrypto)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621685086331"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685086331"><span class="hs-identifier hs-var">_msig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><span class="annottext">(Proof era, Maybe (Script era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-683"></span><span>  </span><span id="local-6989586621685086330"><span class="annot"><span class="annottext">(Addr (EraCrypto era), Value era, [TxOutField era])
</span><a href="#local-6989586621685086330"><span class="hs-identifier hs-var">_bootstrap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-comment">-- | Pick a UTxO element where we can use it in a new Tx. Most of the time we generate new</span><span>
</span><span id="line-686"></span><span class="hs-comment">--   elements for each Tx, but once in a while we choose an existing one. We must be carefull</span><span>
</span><span id="line-687"></span><span class="hs-comment">--   that that the Pay credential of the TxOut can run in the curent ValidityInterval</span><span>
</span><span id="line-688"></span><span class="hs-comment">--   A crude but simple way is to insist Pay credential is either Key locked, or locked</span><span>
</span><span id="line-689"></span><span class="hs-comment">--   with Plutus or MultiSig scripts, and return False for any Timelock scripts.</span><span>
</span><span id="line-690"></span><span id="local-6989586621685087435"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-type">getUtxoElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087435"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087435"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087435"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087435"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-691"></span><span id="getUtxoElem"><span class="annot"><span class="annottext">getUtxoElem :: forall era.
Reflect era =&gt;
GenRS era (Maybe (TxIn (EraCrypto era), TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-var hs-var">getUtxoElem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-692"></span><span>  </span><span id="local-6989586621685086314"><span class="annot"><span class="annottext">Map (TxIn StandardCrypto) (TxOut era)
</span><a href="#local-6989586621685086314"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>  </span><span id="local-6989586621685086313"><span class="annot"><span class="annottext">Map (ScriptHash StandardCrypto) (Script era)
</span><a href="#local-6989586621685086313"><span class="hs-identifier hs-var">scriptmap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn StandardCrypto) (TxOut era)
</span><a href="#local-6989586621685086314"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; Map (ScriptHash (EraCrypto era)) (Script era)
-&gt; TxIn (EraCrypto era)
-&gt; TxOut era
-&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#validTxOut"><span class="hs-identifier hs-var">validTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash StandardCrypto) (Script era)
</span><a href="#local-6989586621685086313"><span class="hs-identifier hs-var">scriptmap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span id="local-6989586621685087421"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-type">getUtxoTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087421"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087421"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-697"></span><span id="getUtxoTest"><span class="annot"><span class="annottext">getUtxoTest :: forall era. GenRS era (TxIn (EraCrypto era) -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-var hs-var">getUtxoTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-698"></span><span>  </span><span id="local-6989586621685086303"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086303"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Map.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621685086303"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">-- | To compute deposits we need a function that tells if the KeyHash is a new Pool</span><span>
</span><span id="line-702"></span><span class="hs-comment">--   Compute this function before we do any generation, since such generation</span><span>
</span><span id="line-703"></span><span class="hs-comment">--   may actually add to the mPoolParams, and then the added thing won't appear new.</span><span>
</span><span id="line-704"></span><span id="local-6989586621685087412"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier hs-type">getNewPoolTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087412"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-705"></span><span id="getNewPoolTest"><span class="annot"><span class="annottext">getNewPoolTest :: forall era. GenRS era (KeyHash 'StakePool (EraCrypto era) -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier hs-var hs-var">getNewPoolTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-706"></span><span>  </span><span id="local-6989586621685086295"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086295"><span class="hs-identifier hs-var">poolparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Map.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086295"><span class="hs-identifier hs-var">poolparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- Tools to get started in the Monad</span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span id="local-6989586621685087409"><span id="local-6989586621685087410"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-type">runGenRS</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-713"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087410"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087410"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-715"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-716"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087410"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-717"></span><span>  </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087409"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087410"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-718"></span><span id="runGenRS"><span class="annot"><span class="annottext">runGenRS :: forall era a.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var hs-var">runGenRS</span></a></span></span><span> </span><span id="local-6989586621685086284"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086284"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086283"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086283"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621685086282"><span class="annot"><span class="annottext">GenRS era a
</span><a href="#local-6989586621685086282"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>  </span><span id="local-6989586621685086281"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086281"><span class="hs-identifier hs-var">genenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
EraPParams era =&gt;
Proof era -&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var">genGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086284"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086283"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621685086280"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086280"><span class="hs-identifier hs-var">ans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685086279"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086279"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runRWST</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era a
</span><a href="#local-6989586621685086282"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086281"><span class="hs-identifier hs-var">genenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var">emptyGenState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086284"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086281"><span class="hs-identifier hs-var">genenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685086280"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086279"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- | Should not be used in tests, this is a helper function to be used in ghci only!</span><span>
</span><span id="line-724"></span><span id="local-6989586621685087396"><span id="local-6989586621685087397"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ioGenRS"><span class="hs-identifier hs-type">ioGenRS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087397"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087397"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087397"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087396"><span class="hs-identifier hs-type">ans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621685087396"><span class="hs-identifier hs-type">ans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-725"></span><span id="ioGenRS"><span class="annot"><span class="annottext">ioGenRS :: forall era ans.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; GenRS era ans -&gt; IO (ans, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#ioGenRS"><span class="hs-identifier hs-var hs-var">ioGenRS</span></a></span></span><span> </span><span id="local-6989586621685086275"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086275"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086274"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086274"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621685086273"><span class="annot"><span class="annottext">GenRS era ans
</span><a href="#local-6989586621685086273"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; IO a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">generate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era a.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var">runGenRS</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086275"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086274"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ans
</span><a href="#local-6989586621685086273"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span class="hs-comment">-- | Generate a random, well-formed, GenEnv</span><span>
</span><span id="line-728"></span><span id="local-6989586621685087403"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-type">genGenEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraPParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087403"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087403"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087403"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-729"></span><span id="genGenEnv"><span class="annot"><span class="annottext">genGenEnv :: forall era.
EraPParams era =&gt;
Proof era -&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var hs-var">genGenEnv</span></a></span></span><span> </span><span id="local-6989586621685086237"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086237"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086236"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086236"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-730"></span><span>  </span><span id="local-6989586621685086235"><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621685086235"><span class="hs-identifier hs-var">maxTxExUnits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span>
</span><span id="line-731"></span><span>  </span><span id="local-6989586621685086234"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685086234"><span class="hs-identifier hs-var">maxCollateralInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086236"><span class="hs-identifier hs-var">gsize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-732"></span><span>  </span><span id="local-6989586621685086233"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685086233"><span class="hs-identifier hs-var">collateralPercentage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">chooseInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>  </span><span id="local-6989586621685086232"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086232"><span class="hs-identifier hs-var">minfeeA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>  </span><span id="local-6989586621685086231"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086231"><span class="hs-identifier hs-var">minfeeB</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086230"><span class="annot"><span class="annottext">pp :: PParams era
</span><a href="#local-6989586621685086230"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="annottext">forall era.
EraPParams era =&gt;
Proof era -&gt; [PParamsField era] -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#newPParams"><span class="hs-identifier hs-var">newPParams</span></a></span><span>
</span><span id="line-737"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086237"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-738"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MinfeeA"><span class="hs-identifier hs-var">MinfeeA</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086232"><span class="hs-identifier hs-var">minfeeA</span></a></span><span>
</span><span id="line-739"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MinfeeB"><span class="hs-identifier hs-var">MinfeeB</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086231"><span class="hs-identifier hs-var">minfeeB</span></a></span><span>
</span><span id="line-740"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#defaultCostModels"><span class="hs-identifier hs-var">defaultCostModels</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086237"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-741"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Natural -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MaxValSize"><span class="hs-identifier hs-var">MaxValSize</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1000</span></span><span>
</span><span id="line-742"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Word32 -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MaxTxSize"><span class="hs-identifier hs-var">MaxTxSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. ExUnits -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MaxTxExUnits"><span class="hs-identifier hs-var">MaxTxExUnits</span></a></span><span> </span><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621685086235"><span class="hs-identifier hs-var">maxTxExUnits</span></a></span><span>
</span><span id="line-744"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Natural -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#MaxCollateralInputs"><span class="hs-identifier hs-var">MaxCollateralInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685086234"><span class="hs-identifier hs-var">maxCollateralInputs</span></a></span><span>
</span><span id="line-745"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Natural -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#CollateralPercentage"><span class="hs-identifier hs-var">CollateralPercentage</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685086233"><span class="hs-identifier hs-var">collateralPercentage</span></a></span><span>
</span><span id="line-746"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. ProtVer -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; ProtVer
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#protocolVersion"><span class="hs-identifier hs-var">protocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086237"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-747"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#PoolDeposit"><span class="hs-identifier hs-var">PoolDeposit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span>
</span><span id="line-748"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#KeyDeposit"><span class="hs-identifier hs-var">KeyDeposit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-749"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. EpochInterval -&gt; PParamsField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#EMax"><span class="hs-identifier hs-var">EMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; EpochInterval
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">EpochInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">5</span></span><span>
</span><span id="line-750"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-751"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-752"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span>
</span><span id="line-753"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gePParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685086230"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-754"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">geSize :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086236"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-755"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span id="local-6989586621685087382"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier hs-type">genGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087382"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087382"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087382"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-758"></span><span id="genGenState"><span class="annot"><span class="annottext">genGenState :: forall era.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; Gen (GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier hs-var hs-var">genGenState</span></a></span></span><span> </span><span id="local-6989586621685086191"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086191"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086190"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086190"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086189"><span class="annot"><span class="annottext">slotNo :: Word64
</span><a href="#local-6989586621685086189"><span class="hs-identifier hs-var hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086190"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-760"></span><span>  </span><span id="local-6989586621685086188"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086188"><span class="hs-identifier hs-var">minSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086189"><span class="hs-identifier hs-var">slotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-761"></span><span>  </span><span id="local-6989586621685086186"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086186"><span class="hs-identifier hs-var">maxSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086189"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086184"><span class="annot"><span class="annottext">vi :: ValidityInterval
</span><a href="#local-6989586621685086184"><span class="hs-identifier hs-var hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086188"><span class="hs-identifier hs-var">minSlotNo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086186"><span class="hs-identifier hs-var">maxSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>  </span><span id="local-6989586621685086183"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086183"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
EraPParams era =&gt;
Proof era -&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var">genGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086191"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086190"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-var">setVi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var">emptyGenState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086191"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621685086183"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685086184"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- | Generate a transaction body validity interval which is close in proximity</span><span>
</span><span id="line-767"></span><span class="hs-comment">--  (less than a stability window) from the current slot.</span><span>
</span><span id="line-768"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-type">genValidityInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span>
</span><span id="line-769"></span><span id="genValidityInterval"><span class="annot"><span class="annottext">genValidityInterval :: SlotNo -&gt; Gen ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-var hs-var">genValidityInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621685086182"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086182"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086180"><span class="annot"><span class="annottext">stabilityWindow :: Word64
</span><a href="#local-6989586621685086180"><span class="hs-identifier hs-var hs-var">stabilityWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">29</span></span><span> </span><span class="hs-comment">-- &lt; 3k/f many slots, where 10k is the epoch length</span><span>
</span><span id="line-771"></span><span>  </span><span id="local-6989586621685086179"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086179"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086182"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-772"></span><span>  </span><span id="local-6989586621685086178"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086178"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086182"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086182"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685086180"><span class="hs-identifier hs-var">stabilityWindow</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086179"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621685086178"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">-- =================================================================</span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-type">pcGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087380"><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#PDoc"><span class="hs-identifier hs-type">PDoc</span></a></span><span>
</span><span id="line-778"></span><span id="pcGenState"><span class="annot"><span class="annottext">pcGenState :: forall era. Reflect era =&gt; Proof era -&gt; GenState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var hs-var">pcGenState</span></a></span></span><span> </span><span id="local-6989586621685086150"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086150"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086149"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-779"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; [(Text, PDoc)] -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppRecord"><span class="hs-identifier hs-var">ppRecord</span></a></span><span>
</span><span id="line-780"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GenState Summary&quot;</span></span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ValidityInterval&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidityInterval -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppValidityInterval"><span class="hs-identifier hs-var">ppValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Keymap&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Scriptmap&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PlutusScripts&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Datums&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;VI-ScriptMap&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppInt"><span class="hs-identifier hs-var">ppInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Model&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; ModelNewEpochState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#pcModelNewEpochState"><span class="hs-identifier hs-var">pcModelNewEpochState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086150"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initial Utxo&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. TxIn c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxIn"><span class="hs-identifier hs-var">pcTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; TxOut era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcTxOut"><span class="hs-identifier hs-var">pcTxOut</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087380"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086150"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initial Rewards&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCoin"><span class="hs-identifier hs-var">pcCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initial SPoolUView&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialDelegations"><span class="hs-identifier hs-var">gsInitialDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initial PoolParams&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. PoolParams era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcPoolParams"><span class="hs-identifier hs-var">pcPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initial PoolDistr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. (k -&gt; PDoc) -&gt; (v -&gt; PDoc) -&gt; Map k v -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppMap"><span class="hs-identifier hs-var">ppMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. IndividualPoolStake c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcIndividualPoolStake"><span class="hs-identifier hs-var">pcIndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era))
     (IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Stable PoolParams&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppSet"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (discriminator :: KeyRole) c.
KeyHash discriminator c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcKeyHash"><span class="hs-identifier hs-var">pcKeyHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Stable Delegators&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppSet"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Previous RegKey&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x ann. (x -&gt; Doc ann) -&gt; Set x -&gt; Doc ann
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppSet"><span class="hs-identifier hs-var">ppSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (keyrole :: KeyRole) c. Credential keyrole c -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#pcCredential"><span class="hs-identifier hs-var">pcCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GenEnv&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppString"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GenEnv ...&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Proof&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; Doc a
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#ppString"><span class="hs-identifier hs-var">ppString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsProof"><span class="hs-identifier hs-var">gsProof</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086149"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span class="hs-comment">-- | Helper function for development and debugging in ghci</span><span>
</span><span id="line-801"></span><span id="local-6989586621685087359"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#viewGenState"><span class="hs-identifier hs-type">viewGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087359"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087359"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-802"></span><span id="viewGenState"><span class="annot"><span class="annottext">viewGenState :: forall era. Reflect era =&gt; Proof era -&gt; GenSize -&gt; Bool -&gt; IO ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#viewGenState"><span class="hs-identifier hs-var hs-var">viewGenState</span></a></span></span><span> </span><span id="local-6989586621685086139"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086139"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685086138"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086138"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621685086137"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621685086137"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-803"></span><span>  </span><span id="local-6989586621685086136"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086136"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Gen a -&gt; IO a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">generate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenSize -&gt; Gen (GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier hs-var">genGenState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086139"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685086138"><span class="hs-identifier hs-var">gsize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621685086137"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; GenState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var">pcGenState</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685086139"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086136"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621685087351"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087351"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#PrettyA"><span class="hs-identifier hs-type">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087351"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621685086129"><span class="annot"><span class="annottext">prettyA :: GenState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.PrettyCore.html#prettyA"><span class="hs-identifier hs-var hs-var hs-var hs-var">prettyA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; GenState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var">pcGenState</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621685086123"><span id="local-6989586621685086126"><span id="local-6989586621685087350"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087350"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087350"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-809"></span><span>  </span><span id="local-6989586621685086119"><span class="annot"><span class="annottext">show :: GenState era -&gt; String
</span><a href="#local-6989586621685086119"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621685086118"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086118"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era -&gt; GenState era -&gt; PDoc
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var">pcGenState</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086118"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- Build an Initial LedgerState for a Trace from a GenState, after</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- generating a coherent Trace (a sequence of Transactions that can</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- logically be applied one after another)</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-type">initialLedgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087349"><span class="annot"><a href="#local-6989586621685087349"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087349"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087349"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087349"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-817"></span><span id="initialLedgerState"><span class="annot"><span class="annottext">initialLedgerState :: forall era. Reflect era =&gt; GenState era -&gt; LedgerState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-var hs-var">initialLedgerState</span></a></span></span><span> </span><span id="local-6989586621685086087"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. UTxOState era -&gt; CertState era -&gt; LedgerState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">LedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621685086085"><span class="hs-identifier hs-var">utxostate</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621685086084"><span class="hs-identifier hs-var">dpstate</span></a></span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-819"></span><span>    </span><span id="local-6989586621685086083"><span class="annot"><span class="annottext">umap :: UMap StandardCrypto
</span><a href="#local-6989586621685086083"><span class="hs-identifier hs-var hs-var">umap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">forall c.
Map (Credential 'Staking c) RDPair
-&gt; Map Ptr (Credential 'Staking c)
-&gt; Map (Credential 'Staking c) (KeyHash 'StakePool c)
-&gt; Map (Credential 'Staking c) (DRep c)
-&gt; UMap c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UM.unify</span></a></span><span>
</span><span id="line-821"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; RDPair
</span><a href="#local-6989586621685086080"><span class="hs-identifier hs-var">rdpair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>        </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-823"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (Credential 'Staking (EraCrypto era))
     (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialDelegations"><span class="hs-identifier hs-var">gsInitialDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-824"></span><span>        </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-825"></span><span>    </span><span id="local-6989586621685086085"><span class="annot"><span class="annottext">utxostate :: UTxOState era
</span><a href="#local-6989586621685086085"><span class="hs-identifier hs-var hs-var">utxostate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
PParams era
-&gt; UTxO era
-&gt; Coin
-&gt; Coin
-&gt; GovState era
-&gt; Coin
-&gt; UTxOState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">smartUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685086079"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086077"><span class="hs-identifier hs-var">deposited</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era. EraGov era =&gt; GovState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">emptyGovState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-826"></span><span>    </span><span id="local-6989586621685086084"><span class="annot"><span class="annottext">dpstate :: CertState era
</span><a href="#local-6989586621685086084"><span class="hs-identifier hs-var hs-var">dpstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. VState era -&gt; PState era -&gt; DState era -&gt; CertState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">CertState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/data-default-class-0.1.2.0-cc61b3e1505bae222166941c5d7d95310a6fc64233e500cdf16191d60ef6520a/share/doc/html/src"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621685086074"><span class="hs-identifier hs-var">pstate</span></a></span><span> </span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621685086073"><span class="hs-identifier hs-var">dstate</span></a></span><span>
</span><span id="line-827"></span><span>    </span><span id="local-6989586621685086073"><span class="annot"><span class="annottext">dstate :: DState era
</span><a href="#local-6989586621685086073"><span class="hs-identifier hs-var hs-var">dstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-828"></span><span>      </span><span class="annot"><span class="annottext">forall era.
UMap (EraCrypto era)
-&gt; Map
     (FutureGenDeleg (EraCrypto era)) (GenDelegPair (EraCrypto era))
-&gt; GenDelegs (EraCrypto era)
-&gt; InstantaneousRewards (EraCrypto era)
-&gt; DState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">DState</span></a></span><span>
</span><span id="line-829"></span><span>        </span><span class="annot"><span class="annottext">UMap StandardCrypto
</span><a href="#local-6989586621685086083"><span class="hs-identifier hs-var">umap</span></a></span><span>
</span><span id="line-830"></span><span>        </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-831"></span><span>        </span><span class="annot"><span class="annottext">forall c. GenDelegs c
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#genDelegsZero"><span class="hs-identifier hs-var">genDelegsZero</span></a></span><span>
</span><span id="line-832"></span><span>        </span><span class="annot"><span class="annottext">forall c. InstantaneousRewards c
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#instantaneousRewardsZero"><span class="hs-identifier hs-var">instantaneousRewardsZero</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span id="local-6989586621685086074"><span class="annot"><span class="annottext">pstate :: PState era
</span><a href="#local-6989586621685086074"><span class="hs-identifier hs-var hs-var">pstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
-&gt; Map (KeyHash 'StakePool (EraCrypto era)) EpochNo
-&gt; Map (KeyHash 'StakePool (EraCrypto era)) Coin
-&gt; PState era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">PState</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086070"><span class="hs-identifier hs-var">pools</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086068"><span class="hs-identifier hs-var">poolDeposit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086070"><span class="hs-identifier hs-var">pools</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-comment">-- In a wellformed LedgerState the deposited equals the obligation</span><span>
</span><span id="line-835"></span><span>    </span><span id="local-6989586621685086077"><span class="annot"><span class="annottext">deposited :: Coin
</span><a href="#local-6989586621685086077"><span class="hs-identifier hs-var hs-var">deposited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraGov era =&gt; CertState era -&gt; GovState era -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">totalObligation</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621685086084"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621685086085"><span class="hs-identifier hs-var">utxostate</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Lens' (UTxOState era) (GovState era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">utxosGovStateL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>    </span><span id="local-6989586621685086070"><span class="annot"><span class="annottext">pools :: Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621685086070"><span class="hs-identifier hs-var hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span id="local-6989586621685086079"><span class="annot"><span class="annottext">pp :: PParams era
</span><a href="#local-6989586621685086079"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. ModelNewEpochState era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621685086087"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>    </span><span id="local-6989586621685086066"><span class="annot"><span class="annottext">keyDeposit :: Coin
</span><a href="#local-6989586621685086066"><span class="hs-identifier hs-var hs-var">keyDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685086079"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppKeyDepositL</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621685086068"><span class="annot"><span class="annottext">poolDeposit :: Coin
</span><a href="#local-6989586621685086068"><span class="hs-identifier hs-var hs-var">poolDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685086079"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppPoolDepositL</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span id="local-6989586621685086080"><span class="annot"><span class="annottext">rdpair :: Coin -&gt; RDPair
</span><a href="#local-6989586621685086080"><span class="hs-identifier hs-var hs-var">rdpair</span></a></span></span><span> </span><span id="local-6989586621685086063"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086063"><span class="hs-identifier hs-var">rew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; CompactForm Coin -&gt; RDPair
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UM.RDPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Coin -&gt; CompactForm Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UM.compactCoinOrError</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086063"><span class="hs-identifier hs-var">rew</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Coin -&gt; CompactForm Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UM.compactCoinOrError</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685086066"><span class="hs-identifier hs-var">keyDeposit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- =============================================</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- Generators of inter-related items</span><span>
</span><span id="line-844"></span><span>
</span><span id="line-845"></span><span class="hs-comment">-- Adds to the gsKeys</span><span>
</span><span id="line-846"></span><span id="local-6989586621685087295"><span id="local-6989586621685087296"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-type">genKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087295"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087296"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-847"></span><span id="genKeyHash"><span class="annot"><span class="annottext">genKeyHash :: forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var hs-var">genKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-848"></span><span>  </span><span id="local-6989586621685086038"><span class="annot"><span class="annottext">KeyPair 'Witness StandardCrypto
</span><a href="#local-6989586621685086038"><span class="hs-identifier hs-var">keyPair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086037"><span class="annot"><span class="annottext">keyHash :: KeyHash 'Witness StandardCrypto
</span><a href="#local-6989586621685086037"><span class="hs-identifier hs-var hs-var">keyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c (kd :: KeyRole). Crypto c =&gt; VKey kd c -&gt; KeyHash kd c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kd :: KeyRole) c. KeyPair kd c -&gt; VKey kd c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">vKey</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness StandardCrypto
</span><a href="#local-6989586621685086038"><span class="hs-identifier hs-var">keyPair</span></a></span><span>
</span><span id="line-850"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'Witness (EraCrypto era))
   (KeyPair 'Witness (EraCrypto era))
 -&gt; Map
      (KeyHash 'Witness (EraCrypto era))
      (KeyPair 'Witness (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-var">modifyGenStateKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness StandardCrypto
</span><a href="#local-6989586621685086037"><span class="hs-identifier hs-var">keyHash</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness StandardCrypto
</span><a href="#local-6989586621685086038"><span class="hs-identifier hs-var">keyPair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness StandardCrypto
</span><a href="#local-6989586621685086037"><span class="hs-identifier hs-var">keyHash</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="hs-comment">-- Adds to the gsDatums</span><span>
</span><span id="line-854"></span><span id="local-6989586621685087278"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-type">genDatumWithHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087278"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087278"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087278"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087278"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-855"></span><span id="genDatumWithHash"><span class="annot"><span class="annottext">genDatumWithHash :: forall era.
Era era =&gt;
GenRS era (DataHash (EraCrypto era), Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var hs-var">genDatumWithHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-856"></span><span>  </span><span id="local-6989586621685086024"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621685086024"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685086023"><span class="annot"><span class="annottext">datumHash :: DataHash (EraCrypto era)
</span><a href="#local-6989586621685086023"><span class="hs-identifier hs-var hs-var">datumHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Data era -&gt; DataHash (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashData</span></a></span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621685086024"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-858"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (DataHash (EraCrypto era)) (Data era)
 -&gt; Map (DataHash (EraCrypto era)) (Data era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-var">modifyGenStateDatums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621685086023"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621685086024"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621685086023"><span class="hs-identifier hs-var">datumHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621685086024"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span id="local-6989586621685086021"><span id="local-6989586621685086022"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-type">genFreshKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086022"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086022"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086021"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685086022"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-862"></span><span id="genFreshKeyHash"><span class="annot"><span class="annottext">genFreshKeyHash :: forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var hs-var">genFreshKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {era} {r :: KeyRole}.
(Num a, Reflect era, Ord a) =&gt;
a
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash r (EraCrypto era))
</span><a href="#local-6989586621685086016"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- avoid unlikely chance of generated hash collisions.</span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-864"></span><span>    </span><span id="local-6989586621685086016"><span class="annot"><span class="annottext">go :: a
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash r (EraCrypto era))
</span><a href="#local-6989586621685086016"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621685085996"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085996"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-865"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085996"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Something very unlikely happened&quot;</span></span><span>
</span><span id="line-866"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-867"></span><span>          </span><span id="local-6989586621685085995"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685085995"><span class="hs-identifier hs-var">avoidKeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-868"></span><span>          </span><span id="local-6989586621685085994"><span class="annot"><span class="annottext">KeyHash r (EraCrypto era)
</span><a href="#local-6989586621685085994"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-869"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash r (EraCrypto era)
</span><a href="#local-6989586621685085994"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621685085995"><span class="hs-identifier hs-var">avoidKeys</span></a></span><span>
</span><span id="line-870"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash r (EraCrypto era))
</span><a href="#local-6989586621685086016"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085996"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-871"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash r (EraCrypto era)
</span><a href="#local-6989586621685085994"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-comment">-- ===========================================================</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- Generate Era agnostic Scripts</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-comment">-- Adds to gsScripts and gsPlutusScripts</span><span>
</span><span id="line-877"></span><span id="local-6989586621685087267"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-type">genScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087267"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087267"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087267"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087267"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-878"></span><span id="genScript"><span class="annot"><span class="annottext">genScript :: forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var hs-var">genScript</span></a></span></span><span> </span><span id="local-6989586621685085980"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085980"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685085979"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085979"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085980"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-879"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085980"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085979"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085980"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085979"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-881"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085980"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085979"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-882"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span>
</span><span id="line-883"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span>
</span><span id="line-884"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Reflect era, ShelleyEraScript era,
 NativeScript era ~ MultiSig era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-var">genMultiSigScript</span></a></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-comment">-- Adds to gsScripts</span><span>
</span><span id="line-887"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-type">genTimelockScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087258"><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">AllegraEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-890"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span id="genTimelockScript"><span class="annot"><span class="annottext">genTimelockScript :: forall era.
(AllegraEraScript era, Reflect era,
 NativeScript era ~ Timelock era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var hs-var">genTimelockScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-892"></span><span>  </span><span id="local-6989586621685085840"><span class="annot"><span class="annottext">vi :: ValidityInterval
</span><a href="#local-6989586621685085840"><span class="hs-identifier hs-var">vi</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span id="local-6989586621685085839"><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621685085839"><span class="hs-identifier hs-var">mBefore</span></a></span></span><span> </span><span id="local-6989586621685085838"><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621685085838"><span class="hs-identifier hs-var">mAfter</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-comment">-- We need to limit how deep these timelocks can go, otherwise this generator will</span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-comment">-- diverge. It also has to stay very shallow because it grows too fast.</span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085837"><span class="annot"><span class="annottext">genNestedTimelock :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085837"><span class="hs-identifier hs-var hs-var">genNestedTimelock</span></a></span></span><span> </span><span id="local-6989586621685085836"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085836"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-896"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085836"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-897"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-898"></span><span>              </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621685085834"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085833"><span class="hs-identifier hs-var">requireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085836"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085832"><span class="hs-identifier hs-var">requireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085836"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085831"><span class="hs-identifier hs-var">requireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085836"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-899"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621685085834"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span>
</span><span id="line-900"></span><span>      </span><span class="annot"><a href="#local-6989586621685085834"><span class="hs-identifier hs-type">nonRecTimelocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-901"></span><span>      </span><span id="local-6989586621685085834"><span class="annot"><span class="annottext">nonRecTimelocks :: [RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621685085834"><span class="hs-identifier hs-var hs-var">nonRecTimelocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-902"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085830"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-903"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span id="local-6989586621685085830"><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085830"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-904"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall {t :: (* -&gt; *) -&gt; * -&gt; *} {era}.
(Monad (t Gen), MonadTrans t, AllegraEraScript era) =&gt;
SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621685085829"><span class="hs-identifier hs-var">requireTimeStart</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621685085839"><span class="hs-identifier hs-var">mBefore</span></a></span><span>
</span><span id="line-905"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {t :: (* -&gt; *) -&gt; * -&gt; *} {era}.
(Monad (t Gen), MonadTrans t, AllegraEraScript era) =&gt;
SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621685085828"><span class="hs-identifier hs-var">requireTimeExpire</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621685085838"><span class="hs-identifier hs-var">mAfter</span></a></span><span>
</span><span id="line-906"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
</span><a href="#local-6989586621685085827"><span class="hs-identifier hs-var">requireSignature</span></a></span><span>
</span><span id="line-907"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-908"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-909"></span><span>      </span><span id="local-6989586621685085827"><span class="annot"><span class="annottext">requireSignature :: RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
</span><a href="#local-6989586621685085827"><span class="hs-identifier hs-var hs-var">requireSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
KeyHash 'Witness (EraCrypto era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireSignature</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-910"></span><span>      </span><span id="local-6989586621685085833"><span class="annot"><span class="annottext">requireAllOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085833"><span class="hs-identifier hs-var hs-var">requireAllOf</span></a></span></span><span> </span><span id="local-6989586621685085822"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085822"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-911"></span><span>        </span><span id="local-6989586621685085821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085821"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-912"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085821"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085837"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085822"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>      </span><span id="local-6989586621685085832"><span class="annot"><span class="annottext">requireAnyOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085832"><span class="hs-identifier hs-var hs-var">requireAnyOf</span></a></span></span><span> </span><span id="local-6989586621685085819"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085819"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-914"></span><span>        </span><span id="local-6989586621685085818"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085818"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var">positiveSingleDigitInt</span></a></span><span>
</span><span id="line-915"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085818"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085837"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085819"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>      </span><span id="local-6989586621685085831"><span class="annot"><span class="annottext">requireMOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085831"><span class="hs-identifier hs-var hs-var">requireMOf</span></a></span></span><span> </span><span id="local-6989586621685085817"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085817"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-917"></span><span>        </span><span id="local-6989586621685085816"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085816"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-918"></span><span>        </span><span id="local-6989586621685085815"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085815"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085816"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085815"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085816"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085837"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085817"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>      </span><span id="local-6989586621685085829"><span class="annot"><span class="annottext">requireTimeStart :: SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621685085829"><span class="hs-identifier hs-var hs-var">requireTimeStart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621685085802"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085802"><span class="hs-identifier hs-var">validFrom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-921"></span><span>        </span><span id="local-6989586621685085801"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085801"><span class="hs-identifier hs-var">minSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085802"><span class="hs-identifier hs-var">validFrom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. AllegraEraScript era =&gt; SlotNo -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-var">RequireTimeStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085801"><span class="hs-identifier hs-var">minSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>      </span><span id="local-6989586621685085828"><span class="annot"><span class="annottext">requireTimeExpire :: SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621685085828"><span class="hs-identifier hs-var hs-var">requireTimeExpire</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621685085789"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085789"><span class="hs-identifier hs-var">validTill</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-924"></span><span>        </span><span id="local-6989586621685085788"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085788"><span class="hs-identifier hs-var">maxSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085789"><span class="hs-identifier hs-var">validTill</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. AllegraEraScript era =&gt; SlotNo -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.6.0.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-var">RequireTimeExpire</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-slotting-0.2.0.0-e9693f3c882e3c559daadeb786b76b020e7055cb4e22023e34d732acc00a7b54/share/doc/html/src"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621685085788"><span class="hs-identifier hs-var">maxSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>  </span><span id="local-6989586621685085787"><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621685085787"><span class="hs-identifier hs-var">tlscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621685085837"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085786"><span class="annot"><span class="annottext">corescript :: Script era
</span><a href="#local-6989586621685085786"><span class="hs-identifier hs-var hs-var">corescript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; NativeScript era -&gt; Script era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">fromNativeScript</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621685085787"><span class="hs-identifier hs-var">tlscript</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085784"><span class="annot"><span class="annottext">scriptHash :: ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085784"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraScript era =&gt;
Script era -&gt; ScriptHash (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085786"><span class="hs-identifier hs-var">corescript</span></a></span><span>
</span><span id="line-929"></span><span>      </span><span id="local-6989586621685085780"><span class="annot"><span class="annottext">insertOrCreate :: a -&gt; Maybe (Set a) -&gt; Maybe (Set a)
</span><a href="#local-6989586621685085780"><span class="hs-identifier hs-var hs-var">insertOrCreate</span></a></span></span><span> </span><span id="local-6989586621685085779"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085779"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085779"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>      </span><span class="annot"><a href="#local-6989586621685085780"><span class="hs-identifier hs-var">insertOrCreate</span></a></span><span> </span><span id="local-6989586621685085777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085777"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621685085776"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621685085776"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621685085777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621685085776"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (ScriptHash (EraCrypto era)) (Script era)
 -&gt; Map (ScriptHash (EraCrypto era)) (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var">modifyGenStateScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085784"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085786"><span class="hs-identifier hs-var">corescript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
 -&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era))))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-var">modifyGenStateVI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.alter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Ord a =&gt; a -&gt; Maybe (Set a) -&gt; Maybe (Set a)
</span><a href="#local-6989586621685085780"><span class="hs-identifier hs-var">insertOrCreate</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085784"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685085840"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085784"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="hs-comment">-- Adds to gsScripts</span><span>
</span><span id="line-936"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-type">genMultiSigScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087250"><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">MultiSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-939"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span id="genMultiSigScript"><span class="annot"><span class="annottext">genMultiSigScript :: forall era.
(Reflect era, ShelleyEraScript era,
 NativeScript era ~ MultiSig era) =&gt;
GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-var hs-var">genMultiSigScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-941"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085720"><span class="annot"><span class="annottext">genNestedMultiSig :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085720"><span class="hs-identifier hs-var hs-var">genNestedMultiSig</span></a></span></span><span> </span><span id="local-6989586621685085719"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085719"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-942"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085719"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-943"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-944"></span><span>              </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621685085718"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085717"><span class="hs-identifier hs-var">requireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085719"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085716"><span class="hs-identifier hs-var">requireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085719"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085715"><span class="hs-identifier hs-var">requireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085719"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-945"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621685085718"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span>
</span><span id="line-946"></span><span>      </span><span id="local-6989586621685085718"><span class="annot"><span class="annottext">nonRecTimelocks :: [RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621685085718"><span class="hs-identifier hs-var hs-var">nonRecTimelocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085714"><span class="hs-identifier hs-var">requireSignature</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-947"></span><span>      </span><span id="local-6989586621685085714"><span class="annot"><span class="annottext">requireSignature :: RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085714"><span class="hs-identifier hs-var hs-var">requireSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
KeyHash 'Witness (EraCrypto era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireSignature</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-948"></span><span>      </span><span id="local-6989586621685085717"><span class="annot"><span class="annottext">requireAllOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085717"><span class="hs-identifier hs-var hs-var">requireAllOf</span></a></span></span><span> </span><span id="local-6989586621685085713"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085713"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-949"></span><span>        </span><span id="local-6989586621685085712"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085712"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-950"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085712"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085720"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085713"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-951"></span><span>      </span><span id="local-6989586621685085716"><span class="annot"><span class="annottext">requireAnyOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085716"><span class="hs-identifier hs-var hs-var">requireAnyOf</span></a></span></span><span> </span><span id="local-6989586621685085711"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085711"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-952"></span><span>        </span><span id="local-6989586621685085710"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085710"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var">positiveSingleDigitInt</span></a></span><span>
</span><span id="line-953"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085710"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085720"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085711"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>      </span><span id="local-6989586621685085715"><span class="annot"><span class="annottext">requireMOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085715"><span class="hs-identifier hs-var hs-var">requireMOf</span></a></span></span><span> </span><span id="local-6989586621685085709"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085709"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-955"></span><span>        </span><span id="local-6989586621685085708"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085708"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-956"></span><span>        </span><span id="local-6989586621685085707"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085707"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085708"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RequireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085707"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; StrictSeq a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085708"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085720"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085709"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>  </span><span id="local-6989586621685085706"><span class="annot"><span class="annottext">MultiSig era
</span><a href="#local-6989586621685085706"><span class="hs-identifier hs-var">msscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621685085720"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085705"><span class="annot"><span class="annottext">corescript :: Script era
</span><a href="#local-6989586621685085705"><span class="hs-identifier hs-var hs-var">corescript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; NativeScript era -&gt; Script era
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">fromNativeScript</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSig era
</span><a href="#local-6989586621685085706"><span class="hs-identifier hs-var">msscript</span></a></span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085704"><span class="annot"><span class="annottext">scriptHash :: ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085704"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraScript era =&gt;
Script era -&gt; ScriptHash (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087250"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085705"><span class="hs-identifier hs-var">corescript</span></a></span><span>
</span><span id="line-961"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (ScriptHash (EraCrypto era)) (Script era)
 -&gt; Map (ScriptHash (EraCrypto era)) (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var">modifyGenStateScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085704"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085705"><span class="hs-identifier hs-var">corescript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085704"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="hs-comment">-- Adds to gsPlutusScripts</span><span>
</span><span id="line-965"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-type">genPlutusScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-966"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685085703"><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-967"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-968"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-969"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-970"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span id="genPlutusScript"><span class="annot"><span class="annottext">genPlutusScript :: forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var hs-var">genPlutusScript</span></a></span></span><span> </span><span id="local-6989586621685085660"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621685085659"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085659"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-972"></span><span>  </span><span id="local-6989586621685085658"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621685085658"><span class="hs-identifier hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">95</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-comment">-- Plutus scripts alwaysSucceeds needs at least numArgs, while</span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-comment">-- alwaysFails needs exactly numArgs to have the desired affect.</span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-comment">-- For reasons unknown, this number differs from Alonzo to Babbage</span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-comment">-- Perhaps because Babbage is using PlutusV2 scripts?</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085657"><span class="annot"><span class="annottext">numArgs :: Natural
</span><a href="#local-6989586621685085657"><span class="hs-identifier hs-var hs-var">numArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085659"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-978"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-979"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-980"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-981"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-982"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span>
</span><span id="line-983"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-comment">-- While using varying number of arguments for alwaysSucceeds we get</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-comment">-- varying script hashes, which helps with the fuzziness</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085648"><span class="annot"><span class="annottext">mlanguage :: Maybe Language
</span><a href="#local-6989586621685085648"><span class="hs-identifier hs-var hs-var">mlanguage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Maybe Language
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#primaryLanguage"><span class="hs-identifier hs-var">primaryLanguage</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-987"></span><span>  </span><span id="local-6989586621685085647"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085647"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-988"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621685085658"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-989"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Maybe Language -&gt; Natural -&gt; Script era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysTrue"><span class="hs-identifier hs-var">alwaysTrue</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621685085648"><span class="hs-identifier hs-var">mlanguage</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085657"><span class="hs-identifier hs-var">numArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-990"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Maybe Language -&gt; Natural -&gt; Script era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysFalse"><span class="hs-identifier hs-var">alwaysFalse</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621685085648"><span class="hs-identifier hs-var">mlanguage</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621685085657"><span class="hs-identifier hs-var">numArgs</span></a></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621685085646"><span class="hs-identifier hs-type">corescript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-993"></span><span>      </span><span id="local-6989586621685085646"><span class="annot"><span class="annottext">corescript :: Script era
</span><a href="#local-6989586621685085646"><span class="hs-identifier hs-var hs-var">corescript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-994"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085647"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-995"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085647"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-996"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085647"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-997"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-998"></span><span>          </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span>
</span><span id="line-999"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PlutusScripts are available starting in the Alonzo era. &quot;</span></span><span>
</span><span id="line-1000"></span><span>                </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621685085660"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-1001"></span><span>                </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not support PlutusScripts.&quot;</span></span><span>
</span><span id="line-1002"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span>      </span><span id="local-6989586621685085642"><span class="annot"><span class="annottext">scriptHash :: ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085642"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
EraScript era =&gt;
Script era -&gt; ScriptHash (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685085703"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085646"><span class="hs-identifier hs-var">corescript</span></a></span><span>
</span><span id="line-1004"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map
   (ScriptHash (EraCrypto era), PlutusPurposeTag)
   (IsValid, Script era)
 -&gt; Map
      (ScriptHash (EraCrypto era), PlutusPurposeTag)
      (IsValid, Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-var">modifyPlutusScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085642"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085659"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.11.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621685085658"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621685085646"><span class="hs-identifier hs-var">corescript</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621685085642"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span class="hs-comment">-- ======================================================================</span><span>
</span><span id="line-1008"></span><span class="hs-comment">-- Generators of Transaction components</span><span>
</span><span id="line-1009"></span><span class="hs-comment">-- =======================================================================</span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- | Generate a credential that can be used for supplied purpose (in case of</span><span>
</span><span id="line-1012"></span><span class="hs-comment">-- plutus scripts), while occasionally picking out randomly from previously</span><span>
</span><span id="line-1013"></span><span class="hs-comment">-- generated set. Returns the credential</span><span>
</span><span id="line-1014"></span><span class="hs-comment">-- Adds to both gsKeys and gsScripts and gsPlutusScript</span><span>
</span><span id="line-1015"></span><span class="hs-comment">-- via genKeyHash and genScript</span><span>
</span><span id="line-1016"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-type">genCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087215"><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621685087214"><span class="annot"><a href="#local-6989586621685087214"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087214"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span id="genCredential"><span class="annot"><span class="annottext">genCredential :: forall era (kr :: KeyRole).
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var hs-var">genCredential</span></a></span></span><span> </span><span id="local-6989586621685085565"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1019"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-1020"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">35</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash kr StandardCrypto)
</span><a href="#local-6989586621685085564"><span class="hs-identifier hs-var">genKeyHash'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">35</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. ScriptHash c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085563"><span class="hs-identifier hs-var">genScript'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085562"><span class="hs-identifier hs-var">pickExistingKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085561"><span class="hs-identifier hs-var">pickExistingScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1025"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1026"></span><span>    </span><span id="local-6989586621685085564"><span class="annot"><span class="annottext">genKeyHash' :: RWST (GenEnv era) () (GenState era) Gen (KeyHash kr StandardCrypto)
</span><a href="#local-6989586621685085564"><span class="hs-identifier hs-var hs-var">genKeyHash'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1027"></span><span>      </span><span id="local-6989586621685085560"><span class="annot"><span class="annottext">KeyHash 'Staking StandardCrypto
</span><a href="#local-6989586621685085560"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var">genFreshKeyHash</span></a></span><span> </span><span class="hs-comment">-- We need to avoid some key credentials</span><span>
</span><span id="line-1028"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1029"></span><span>        </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking StandardCrypto
</span><a href="#local-6989586621685085560"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1030"></span><span>        </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking StandardCrypto
</span><a href="#local-6989586621685085560"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-1032"></span><span>    </span><span id="local-6989586621685085563"><span class="annot"><span class="annottext">genScript' :: RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085563"><span class="hs-identifier hs-var hs-var">genScript'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085559"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1034"></span><span>        </span><span id="local-6989586621685085559"><span class="annot"><span class="annottext">f :: Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085559"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621685085558"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085558"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1035"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085558"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to generate a fresh script hash&quot;</span></span><span>
</span><span id="line-1036"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1037"></span><span>              </span><span id="local-6989586621685085557"><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085557"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-1038"></span><span>              </span><span id="local-6989586621685085556"><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085556"><span class="hs-identifier hs-var">initialRewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span>
</span><span id="line-1039"></span><span>              </span><span id="local-6989586621685085555"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085555"><span class="hs-identifier hs-var">avoidCredentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1040"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085554"><span class="annot"><span class="annottext">newcred :: Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085554"><span class="hs-identifier hs-var hs-var">newcred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. ScriptHash c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085557"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-1041"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.notMember</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085554"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085556"><span class="hs-identifier hs-var">initialRewards</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.notMember</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085554"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085555"><span class="hs-identifier hs-var">avoidCredentials</span></a></span><span>
</span><span id="line-1042"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1043"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1044"></span><span>                    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085554"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>                    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>                  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085557"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-1047"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085559"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085558"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1048"></span><span>    </span><span id="local-6989586621685085562"><span class="annot"><span class="annottext">pickExistingKeyHash :: RWST
  (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085562"><span class="hs-identifier hs-var hs-var">pickExistingKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1050"></span><span>        </span><span id="local-6989586621685085550"><span class="annot"><span class="annottext">Map
  (KeyHash 'Witness StandardCrypto) (KeyPair 'Witness StandardCrypto)
</span><a href="#local-6989586621685085550"><span class="hs-identifier hs-var">keysMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1051"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var">genMapElem</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'Witness StandardCrypto) (KeyPair 'Witness StandardCrypto)
</span><a href="#local-6989586621685085550"><span class="hs-identifier hs-var">keysMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1052"></span><span>          </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621685085549"><span class="annot"><span class="annottext">KeyHash 'Witness StandardCrypto
</span><a href="#local-6989586621685085549"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness StandardCrypto
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness StandardCrypto
</span><a href="#local-6989586621685085549"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1053"></span><span>          </span><span class="annot"><span class="annottext">Maybe
  (KeyHash 'Witness StandardCrypto, KeyPair 'Witness StandardCrypto)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash kr StandardCrypto)
</span><a href="#local-6989586621685085564"><span class="hs-identifier hs-var">genKeyHash'</span></a></span><span>
</span><span id="line-1054"></span><span>    </span><span id="local-6989586621685085561"><span class="annot"><span class="annottext">pickExistingScript :: RWST
  (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085561"><span class="hs-identifier hs-var hs-var">pickExistingScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1055"></span><span>      </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. ScriptHash c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span>
</span><span id="line-1056"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085548"><span class="hs-identifier hs-var">pickExistingPlutusScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085547"><span class="hs-identifier hs-var">pickExistingTimelockScript</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1057"></span><span>    </span><span id="local-6989586621685085548"><span class="annot"><span class="annottext">pickExistingPlutusScript :: RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085548"><span class="hs-identifier hs-var hs-var">pickExistingPlutusScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1058"></span><span>      </span><span id="local-6989586621685085546"><span class="annot"><span class="annottext">Map
  (ScriptHash StandardCrypto, PlutusPurposeTag) (IsValid, Script era)
</span><a href="#local-6989586621685085546"><span class="hs-identifier hs-var">plutusScriptsMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1059"></span><span>        </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.filterWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085544"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085544"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IsValid, Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085544"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (ScriptHash (EraCrypto era), PlutusPurposeTag)
     (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1060"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var">genMapElem</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (ScriptHash StandardCrypto, PlutusPurposeTag) (IsValid, Script era)
</span><a href="#local-6989586621685085546"><span class="hs-identifier hs-var">plutusScriptsMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1061"></span><span>        </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621685085543"><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085543"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(IsValid, Script era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085543"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1062"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  ((ScriptHash StandardCrypto, PlutusPurposeTag),
   (IsValid, Script era))
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-1063"></span><span>    </span><span id="local-6989586621685085547"><span class="annot"><span class="annottext">pickExistingTimelockScript :: RWST (GenEnv era) () (GenState era) Gen (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085547"><span class="hs-identifier hs-var hs-var">pickExistingTimelockScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1064"></span><span>      </span><span class="hs-comment">-- Only pick one if it matches the</span><span>
</span><span id="line-1065"></span><span>      </span><span id="local-6989586621685085542"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685085542"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-comment">-- current ValidityInterval</span><span>
</span><span id="line-1066"></span><span>      </span><span id="local-6989586621685085541"><span class="annot"><span class="annottext">Map ValidityInterval (Set (ScriptHash StandardCrypto))
</span><a href="#local-6989586621685085541"><span class="hs-identifier hs-var">vimap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map ValidityInterval (Set (ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span>
</span><span id="line-1067"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621685085542"><span class="hs-identifier hs-var">vi</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidityInterval (Set (ScriptHash StandardCrypto))
</span><a href="#local-6989586621685085541"><span class="hs-identifier hs-var">vimap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1068"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set (ScriptHash StandardCrypto))
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621685087215"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-1069"></span><span>        </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621685085540"><span class="annot"><span class="annottext">Set (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085540"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1070"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; Gen (Maybe a)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-var">genSetElem</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash StandardCrypto)
</span><a href="#local-6989586621685085540"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1071"></span><span>            </span><span class="annot"><span class="annottext">Maybe (ScriptHash StandardCrypto)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; PlutusPurposeTag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085565"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-1072"></span><span>            </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621685085539"><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085539"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621685085539"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span class="hs-comment">-- Return a fresh credential, one that is not a member of the set 'old'.</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- One gets 'tries' chances to generate a fresh one, before an error is raised.</span><span>
</span><span id="line-1076"></span><span class="hs-comment">-- This avoids silent infinite loops.</span><span>
</span><span id="line-1077"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-type">genFreshCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1078"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087201"><span class="annot"><a href="#local-6989586621685087201"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621685087200"><span class="annot"><a href="#local-6989586621685087200"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1079"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087201"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1080"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1081"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1082"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087200"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087201"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1083"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087201"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087200"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087201"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1084"></span><span id="genFreshCredential"><span class="annot"><span class="annottext">genFreshCredential :: forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var hs-var">genFreshCredential</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621685085524"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085524"><span class="hs-identifier hs-var">_tag</span></a></span></span><span> </span><span id="local-6989586621685085523"><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085523"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran out of tries in genFreshCredential.&quot;</span></span><span>
</span><span id="line-1085"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span id="local-6989586621685085522"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085522"><span class="hs-identifier hs-var">tries0</span></a></span></span><span> </span><span id="local-6989586621685085521"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085521"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621685085520"><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085520"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085519"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085522"><span class="hs-identifier hs-var">tries0</span></a></span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1087"></span><span>    </span><span id="local-6989586621685085519"><span class="annot"><span class="annottext">go :: Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085519"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621685085518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085518"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1088"></span><span>      </span><span id="local-6989586621685085517"><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085517"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085521"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-1089"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085517"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085520"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-1090"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085519"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085518"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085517"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span id="local-6989586621685087197"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-type">genFreshRegCred</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1094"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087197"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087197"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087197"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1095"></span><span id="genFreshRegCred"><span class="annot"><span class="annottext">genFreshRegCred :: forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var hs-var">genFreshRegCred</span></a></span></span><span> </span><span id="local-6989586621685085494"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085494"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1096"></span><span>  </span><span id="local-6989586621685085493"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085493"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1097"></span><span>  </span><span id="local-6989586621685085491"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085491"><span class="hs-identifier hs-var">avoid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1098"></span><span>  </span><span id="local-6989586621685085490"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085490"><span class="hs-identifier hs-var">rewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mRewards"><span class="hs-identifier hs-var">mRewards</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-1099"></span><span>  </span><span id="local-6989586621685085489"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085489"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085494"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085493"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085491"><span class="hs-identifier hs-var">avoid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085490"><span class="hs-identifier hs-var">rewards</span></a></span><span>
</span><span id="line-1100"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Set (Credential 'Staking (EraCrypto era))
 -&gt; Set (Credential 'Staking (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085489"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085489"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span id="local-6989586621685087191"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-type">genPoolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1104"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087191"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1105"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087191"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1106"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087191"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087191"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1107"></span><span id="genPoolParams"><span class="annot"><span class="annottext">genPoolParams :: forall era.
Reflect era =&gt;
KeyHash 'StakePool (EraCrypto era)
-&gt; GenRS era (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-var hs-var">genPoolParams</span></a></span></span><span> </span><span id="local-6989586621685085455"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085455"><span class="hs-identifier hs-var">ppId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1108"></span><span>  </span><span id="local-6989586621685085454"><span class="annot"><span class="annottext">Hash Blake2b_256 (VerKeyVRF PraosVRF)
</span><a href="#local-6989586621685085454"><span class="hs-identifier hs-var">ppVrf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-1109"></span><span>  </span><span id="local-6989586621685085453"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685085453"><span class="hs-identifier hs-var">ppPledge</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-1110"></span><span>  </span><span id="local-6989586621685085452"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685085452"><span class="hs-identifier hs-var">ppCost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-1111"></span><span>  </span><span id="local-6989586621685085451"><span class="annot"><span class="annottext">UnitInterval
</span><a href="#local-6989586621685085451"><span class="hs-identifier hs-var">ppMargin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-1112"></span><span>  </span><span id="local-6989586621685085450"><span class="annot"><span class="annottext">RewardAccount StandardCrypto
</span><a href="#local-6989586621685085450"><span class="hs-identifier hs-var">ppRewardAccount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall c. Network -&gt; Credential 'Staking c -&gt; RewardAccount c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">RewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Testnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085445"><span class="annot"><span class="annottext">ppOwners :: Set (KeyHash 'Staking StandardCrypto)
</span><a href="#local-6989586621685085445"><span class="hs-identifier hs-var hs-var">ppOwners</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085442"><span class="annot"><span class="annottext">ppRelays :: StrictSeq StakePoolRelay
</span><a href="#local-6989586621685085442"><span class="hs-identifier hs-var hs-var">ppRelays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085441"><span class="annot"><span class="annottext">ppMetadata :: StrictMaybe a
</span><a href="#local-6989586621685085441"><span class="hs-identifier hs-var hs-var">ppMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/cardano-strict-containers-0.1.3.0-02824dbe7a6e325f56f5594c869dfb54025c80a476fc3671ac01b6da9422d55e/share/doc/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-1116"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Set (KeyHash 'Staking StandardCrypto)
Hash Blake2b_256 (VerKeyVRF PraosVRF)
Coin
RewardAccount StandardCrypto
StrictSeq StakePoolRelay
UnitInterval
KeyHash 'StakePool (EraCrypto era)
forall a. StrictMaybe a
ppId :: KeyHash 'StakePool StandardCrypto
ppVrf :: Hash StandardCrypto (VerKeyVRF StandardCrypto)
ppPledge :: Coin
ppCost :: Coin
ppMargin :: UnitInterval
ppRewardAccount :: RewardAccount StandardCrypto
ppOwners :: Set (KeyHash 'Staking StandardCrypto)
ppRelays :: StrictSeq StakePoolRelay
ppMetadata :: StrictMaybe PoolMetadata
ppMetadata :: forall a. StrictMaybe a
ppRelays :: StrictSeq StakePoolRelay
ppOwners :: Set (KeyHash 'Staking StandardCrypto)
ppRewardAccount :: RewardAccount StandardCrypto
ppMargin :: UnitInterval
ppCost :: Coin
ppPledge :: Coin
ppVrf :: Hash Blake2b_256 (VerKeyVRF PraosVRF)
ppId :: KeyHash 'StakePool (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1117"></span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- | Generate a 'n' fresh credentials (ones not in the set 'old'). We get 'tries' chances,</span><span>
</span><span id="line-1119"></span><span class="hs-comment">--   if it doesn't work in 'tries' attempts then quit with an error. Better to raise an error</span><span>
</span><span id="line-1120"></span><span class="hs-comment">--   than go into an infinite loop.</span><span>
</span><span id="line-1121"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-type">genFreshCredentials</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087171"><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621685087170"><span class="annot"><a href="#local-6989586621685087170"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1123"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1124"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1125"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1126"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1127"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087170"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1128"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087170"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1129"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087170"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087171"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1130"></span><span id="genFreshCredentials"><span class="annot"><span class="annottext">genFreshCredentials :: forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; [Credential kr (EraCrypto era)]
-&gt; GenRS era [Credential kr (EraCrypto era)]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var hs-var">genFreshCredentials</span></a></span></span><span> </span><span id="local-6989586621685085413"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085413"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621685085412"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085412"><span class="hs-identifier hs-var">_tag</span></a></span></span><span> </span><span id="local-6989586621685085411"><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085411"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621685085410"><span class="annot"><span class="annottext">[Credential kr (EraCrypto era)]
</span><a href="#local-6989586621685085410"><span class="hs-identifier hs-var">_ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran out of tries in genFreshCredentials.&quot;</span></span><span>
</span><span id="line-1131"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var">genFreshCredentials</span></a></span><span> </span><span id="local-6989586621685085409"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085409"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span id="local-6989586621685085408"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085408"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span id="local-6989586621685085407"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085407"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621685085406"><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085406"><span class="hs-identifier hs-var">old0</span></a></span></span><span> </span><span id="local-6989586621685085405"><span class="annot"><span class="annottext">[Credential kr (EraCrypto era)]
</span><a href="#local-6989586621685085405"><span class="hs-identifier hs-var">ans0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Set (Credential kr StandardCrypto)
-&gt; [Credential kr StandardCrypto]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [Credential kr StandardCrypto]
</span><a href="#local-6989586621685085404"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085409"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr (EraCrypto era))
</span><a href="#local-6989586621685085406"><span class="hs-identifier hs-var">old0</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential kr (EraCrypto era)]
</span><a href="#local-6989586621685085405"><span class="hs-identifier hs-var">ans0</span></a></span><span>
</span><span id="line-1132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1133"></span><span>    </span><span id="local-6989586621685085404"><span class="annot"><span class="annottext">go :: Int
-&gt; Set (Credential kr StandardCrypto)
-&gt; [Credential kr StandardCrypto]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [Credential kr StandardCrypto]
</span><a href="#local-6989586621685085404"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr StandardCrypto)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621685085403"><span class="annot"><span class="annottext">[Credential kr StandardCrypto]
</span><a href="#local-6989586621685085403"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential kr StandardCrypto]
</span><a href="#local-6989586621685085403"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-1134"></span><span>    </span><span class="annot"><a href="#local-6989586621685085404"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621685085402"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085402"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621685085401"><span class="annot"><span class="annottext">Set (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085401"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621685085400"><span class="annot"><span class="annottext">[Credential kr StandardCrypto]
</span><a href="#local-6989586621685085400"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1135"></span><span>      </span><span id="local-6989586621685085399"><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085399"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085408"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621685085407"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085401"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-1136"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; Set (Credential kr StandardCrypto)
-&gt; [Credential kr StandardCrypto]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [Credential kr StandardCrypto]
</span><a href="#local-6989586621685085404"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085402"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085399"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr StandardCrypto)
</span><a href="#local-6989586621685085401"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential kr StandardCrypto
</span><a href="#local-6989586621685085399"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential kr StandardCrypto]
</span><a href="#local-6989586621685085400"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- | Use this function to get a new pool that should not be used in the future transactions</span><span>
</span><span id="line-1139"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-type">genNewPool</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1140"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087167"><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1141"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1142"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-1143"></span><span>    </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1144"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1147"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span id="genNewPool"><span class="annot"><span class="annottext">genNewPool :: forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era),
   IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var hs-var">genNewPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1149"></span><span>  </span><span id="local-6989586621685085375"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085375"><span class="hs-identifier hs-var">poolId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var">genFreshKeyHash</span></a></span><span>
</span><span id="line-1150"></span><span>  </span><span id="local-6989586621685085374"><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085374"><span class="hs-identifier hs-var">poolParam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
KeyHash 'StakePool (EraCrypto era)
-&gt; GenRS era (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-var">genPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085375"><span class="hs-identifier hs-var">poolId</span></a></span><span>
</span><span id="line-1151"></span><span>  </span><span id="local-6989586621685085373"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621685085373"><span class="hs-identifier hs-var">percent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085372"><span class="annot"><span class="annottext">stake :: IndividualPoolStake (EraCrypto era)
</span><a href="#local-6989586621685085372"><span class="hs-identifier hs-var hs-var">stake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
Rational
-&gt; CompactForm Coin
-&gt; Hash c (VerKeyVRF c)
-&gt; IndividualPoolStake c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">IndividualPoolStake</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Real a =&gt; a -&gt; Rational
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toRational</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621685085373"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. PoolParams c -&gt; Hash c (VerKeyVRF c)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppVrf</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085374"><span class="hs-identifier hs-var">poolParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Set (KeyHash 'StakePool (EraCrypto era))
 -&gt; Set (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085375"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085375"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085374"><span class="hs-identifier hs-var">poolParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake (EraCrypto era)
</span><a href="#local-6989586621685085372"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1155"></span><span>
</span><span id="line-1156"></span><span class="hs-comment">-- | Initialize (or overwrite if they are not empty) the Stable fields. It is</span><span>
</span><span id="line-1157"></span><span class="hs-comment">--   intended that this be called just once at the beginning of a trace generation.</span><span>
</span><span id="line-1158"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-type">initStableFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087162"><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span id="initStableFields"><span class="annot"><span class="annottext">initStableFields :: forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var hs-var">initStableFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1160"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621685085312"><span class="annot"><span class="annottext">GenSize
geSize :: GenSize
geSize :: forall era. GenEnv era -&gt; GenSize
</span><a href="#local-6989586621685085312"><span class="hs-identifier hs-var hs-var">geSize</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m r
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-1161"></span><span>  </span><span id="local-6989586621685085311"><span class="annot"><span class="annottext">[KeyHash 'StakePool StandardCrypto]
</span><a href="#local-6989586621685085311"><span class="hs-identifier hs-var">hashes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685085312"><span class="hs-identifier hs-var">geSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1162"></span><span>    </span><span id="local-6989586621685085310"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085310"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621685085309"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085308"><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085308"><span class="hs-identifier hs-var">poolParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085307"><span class="annot"><span class="annottext">IndividualPoolStake StandardCrypto
</span><a href="#local-6989586621685085307"><span class="hs-identifier hs-var">ips</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era),
   IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1164"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Set (KeyHash 'StakePool (EraCrypto era))
 -&gt; Set (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-var">modifyGenStateStablePools</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1165"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085308"><span class="hs-identifier hs-var">poolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1166"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake StandardCrypto
</span><a href="#local-6989586621685085307"><span class="hs-identifier hs-var">ips</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolParams"><span class="hs-identifier hs-var">modifyModelPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085308"><span class="hs-identifier hs-var">poolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>    </span><span class="annot"><span class="annottext">forall era.
KeyHash 'StakePool (EraCrypto era) -&gt; Coin -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelKeyDeposits"><span class="hs-identifier hs-var">modifyModelKeyDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085310"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppPoolDepositL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085309"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span>  </span><span class="hs-comment">-- This incantation gets a list of fresh (not previously generated) Credential</span><span>
</span><span id="line-1172"></span><span>  </span><span id="local-6989586621685085306"><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085306"><span class="hs-identifier hs-var">credentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621685085312"><span class="hs-identifier hs-var">geSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1173"></span><span>    </span><span id="local-6989586621685085305"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085305"><span class="hs-identifier hs-var">old'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1174"></span><span>    </span><span id="local-6989586621685085304"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085304"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1175"></span><span>    </span><span id="local-6989586621685085303"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085303"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085305"><span class="hs-identifier hs-var">old'</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085304"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1176"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Set (Credential 'Staking (EraCrypto era))
 -&gt; Set (Credential 'Staking (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-var">modifyGenStateStableDelegators</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085303"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>    </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085303"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085303"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621685085301"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087162"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span>      </span><span id="local-6989586621685085301"><span class="annot"><span class="annottext">f :: Credential 'Staking (EraCrypto era)
-&gt; KeyHash 'StakePool (EraCrypto era) -&gt; GenRS era ()
</span><a href="#local-6989586621685085301"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621685085300"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685085300"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621685085299"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085299"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1181"></span><span>        </span><span id="local-6989586621685085298"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085298"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1182"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621685085297"><span class="annot"><span class="annottext">keyDeposit :: Coin
</span><a href="#local-6989586621685085297"><span class="hs-identifier hs-var hs-var">keyDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085298"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppKeyDepositL</span></a></span><span>
</span><span id="line-1183"></span><span>        </span><span class="annot"><span class="annottext">forall era.
(Map
   (Credential 'Staking (EraCrypto era))
   (KeyHash 'StakePool (EraCrypto era))
 -&gt; Map
      (Credential 'Staking (EraCrypto era))
      (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDelegations"><span class="hs-identifier hs-var">modifyModelDelegations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685085300"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085299"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1184"></span><span>        </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelRewards"><span class="hs-identifier hs-var">modifyModelRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685085300"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1185"></span><span>        </span><span class="annot"><span class="annottext">forall era. (Coin -&gt; Coin) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-var">modifyModelDeposited</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685085297"><span class="hs-identifier hs-var">keyDeposit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>        </span><span class="annot"><span class="annottext">forall era.
Credential 'Staking (EraCrypto era) -&gt; Coin -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyKeyDeposits"><span class="hs-identifier hs-var">modifyKeyDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685085300"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621685085297"><span class="hs-identifier hs-var">keyDeposit</span></a></span><span>
</span><span id="line-1187"></span><span>        </span><span class="annot"><span class="annottext">forall era.
(Map
   (Credential 'Staking (EraCrypto era))
   (KeyHash 'StakePool (EraCrypto era))
 -&gt; Map
      (Credential 'Staking (EraCrypto era))
      (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialDelegations"><span class="hs-identifier hs-var">modifyGenStateInitialDelegations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621685085300"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085299"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1188"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zipWithM_</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
-&gt; KeyHash 'StakePool (EraCrypto era) -&gt; GenRS era ()
</span><a href="#local-6989586621685085301"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085306"><span class="hs-identifier hs-var">credentials</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool StandardCrypto]
</span><a href="#local-6989586621685085311"><span class="hs-identifier hs-var">hashes</span></a></span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- =============================================</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- Generators of inter-related items</span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span class="hs-comment">-- Adds to the rewards of the ModelNewEpochState. This used exclusively to generate Withdrawals, so</span><span>
</span><span id="line-1194"></span><span class="hs-comment">-- we mark these as ones to avoid in the future. Especialy when generating DeRegKey.</span><span>
</span><span id="line-1195"></span><span id="local-6989586621685087146"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-type">genRewards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087146"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087146"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.14.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">RewardAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087146"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1196"></span><span id="genRewards"><span class="annot"><span class="annottext">genRewards :: forall era.
Reflect era =&gt;
GenRS era (RewardAccounts (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-var hs-var">genRewards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1197"></span><span>  </span><span id="local-6989586621685085237"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085237"><span class="hs-identifier hs-var">wmax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span>  </span><span id="local-6989586621685085236"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085236"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.15.0.1-4019c8c32cd83e4551b6cacd38479a53d08da5213f8f0afe416c11ef11d8101d/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085237"><span class="hs-identifier hs-var">wmax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>  </span><span class="hs-comment">-- we need a fresh credential, one that was not previously</span><span>
</span><span id="line-1200"></span><span>  </span><span class="hs-comment">-- generated here, or one that arose from gsAvoidCred (i.e. prev)</span><span>
</span><span id="line-1201"></span><span>  </span><span id="local-6989586621685085235"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085235"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialRewards"><span class="hs-identifier hs-var">gsInitialRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span>  </span><span id="local-6989586621685085234"><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085234"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1203"></span><span>  </span><span id="local-6989586621685085233"><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085233"><span class="hs-identifier hs-var">credentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr (EraCrypto era))
-&gt; [Credential kr (EraCrypto era)]
-&gt; GenRS era [Credential kr (EraCrypto era)]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var">genFreshCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621685085236"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085235"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621685085234"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1204"></span><span>  </span><span id="local-6989586621685085232"><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085232"><span class="hs-identifier hs-var">newRewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685085230"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085230"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085230"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-var">genRewardVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085233"><span class="hs-identifier hs-var">credentials</span></a></span><span>
</span><span id="line-1205"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelRewards"><span class="hs-identifier hs-var">modifyModelRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685085229"><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621685085229"><span class="hs-identifier hs-var">rewards</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s t. Embed s t =&gt; Exp t -&gt; s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621685085229"><span class="hs-identifier hs-var">rewards</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s1 (f :: * -&gt; * -&gt; *) v s2 (g :: * -&gt; * -&gt; *).
(Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-operator hs-var">&#10755;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085232"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Prefers coins in newrewards</span><span>
</span><span id="line-1206"></span><span>  </span><span id="local-6989586621685085228"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085228"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1207"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sequence_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685085226"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085226"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Credential 'Staking (EraCrypto era) -&gt; Coin -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyKeyDeposits"><span class="hs-identifier hs-var">modifyKeyDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621685085226"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621685085228"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/microlens-0.4.13.1-8b2bea885eb8212a3ebcb31d917de3abc20fe0aa9e677bbb15eac33f7b96228a/share/doc/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppKeyDepositL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085233"><span class="hs-identifier hs-var">credentials</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1208"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685085225"><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621685085225"><span class="hs-identifier hs-var">rewards</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s t. Embed s t =&gt; Exp t -&gt; s
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621685085225"><span class="hs-identifier hs-var">rewards</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s1 (f :: * -&gt; * -&gt; *) v s2 (g :: * -&gt; * -&gt; *).
(Ord k, HasExp s1 (f k v), HasExp s2 (g k v)) =&gt;
s1 -&gt; s2 -&gt; Exp (f k v)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/set-algebra-1.1.0.3/doc/html/set-algebra/src"><span class="hs-operator hs-var">&#10755;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085232"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Set (Credential 'Staking (EraCrypto era))
 -&gt; Set (Credential 'Staking (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking StandardCrypto]
</span><a href="#local-6989586621685085233"><span class="hs-identifier hs-var">credentials</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking StandardCrypto) Coin
</span><a href="#local-6989586621685085232"><span class="hs-identifier hs-var">newRewards</span></a></span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-type">genRetirementHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087119"><span class="annot"><a href="#local-6989586621685087119"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087119"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087119"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087119"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span id="genRetirementHash"><span class="annot"><span class="annottext">genRetirementHash :: forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-var hs-var">genRetirementHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1214"></span><span>  </span><span id="local-6989586621685085191"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool StandardCrypto) (PoolParams StandardCrypto)
</span><a href="#local-6989586621685085191"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>  </span><span id="local-6989586621685085190"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085190"><span class="hs-identifier hs-var">honestKhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span>
</span><span id="line-1216"></span><span>  </span><span id="local-6989586621685085189"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085189"><span class="hs-identifier hs-var">avoidKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-1217"></span><span>  </span><span id="local-6989586621685085188"><span class="annot"><span class="annottext">Maybe
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085188"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool StandardCrypto) (PoolParams StandardCrypto)
</span><a href="#local-6989586621685085191"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621685085187"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085187"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1218"></span><span>    </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085187"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085190"><span class="hs-identifier hs-var">honestKhs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085187"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085189"><span class="hs-identifier hs-var">avoidKey</span></a></span><span>
</span><span id="line-1219"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085188"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1220"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621685085186"><span class="annot"><span class="annottext">(KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085186"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1221"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Set (KeyHash 'StakePool (EraCrypto era))
 -&gt; Set (KeyHash 'StakePool (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085186"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1222"></span><span>      </span><span class="hs-comment">-- if it is retiring, we should probably avoid it in the future</span><span>
</span><span id="line-1223"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085186"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1224"></span><span>    </span><span class="annot"><span class="annottext">Maybe
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1225"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621685085185"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085184"><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085184"><span class="hs-identifier hs-var">poolparams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085183"><span class="annot"><span class="annottext">IndividualPoolStake StandardCrypto
</span><a href="#local-6989586621685085183"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era),
   IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span>      </span><span class="hs-comment">-- add the Pool to the initial state</span><span>
</span><span id="line-1228"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085184"><span class="hs-identifier hs-var">poolparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake StandardCrypto
</span><a href="#local-6989586621685085183"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span>
</span><span id="line-1231"></span><span>      </span><span class="hs-comment">-- add the Pool to the Model</span><span>
</span><span id="line-1232"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolParams"><span class="hs-identifier hs-var">modifyModelPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085184"><span class="hs-identifier hs-var">poolparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-var">modifyModelPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake StandardCrypto
</span><a href="#local-6989586621685085183"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085185"><span class="hs-identifier hs-var">poolid</span></a></span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- Adds to the mPoolParams and the  mPoolDistr of the Model, and the initial set of objects for Traces</span><span>
</span><span id="line-1237"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-type">genPool</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1238"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621685087115"><span class="annot"><a href="#local-6989586621685087115"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1239"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087115"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1240"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087115"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087115"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.15.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621685087115"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span id="genPool"><span class="annot"><span class="annottext">genPool :: forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-var hs-var">genPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era))
</span><a href="#local-6989586621685085165"><span class="hs-identifier hs-var">genNew</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">90</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085164"><span class="hs-identifier hs-var">pickExisting</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1243"></span><span>    </span><span id="local-6989586621685085165"><span class="annot"><span class="annottext">genNew :: RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era))
</span><a href="#local-6989586621685085165"><span class="hs-identifier hs-var hs-var">genNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1244"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621685085152"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085152"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085151"><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621685085151"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085150"><span class="annot"><span class="annottext">IndividualPoolStake (EraCrypto era)
</span><a href="#local-6989586621685085150"><span class="hs-identifier hs-var">ips</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era),
   IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1245"></span><span>      </span><span class="hs-comment">-- add pool to initial state</span><span>
</span><span id="line-1246"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085152"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621685085151"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1247"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era))
   (IndividualPoolStake (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era))
      (IndividualPoolStake (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085152"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake (EraCrypto era)
</span><a href="#local-6989586621685085150"><span class="hs-identifier hs-var">ips</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>      </span><span class="hs-comment">-- update the model</span><span>
</span><span id="line-1249"></span><span>      </span><span class="annot"><span class="annottext">forall era.
(Map
   (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
 -&gt; Map
      (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolParams"><span class="hs-identifier hs-var">modifyModelPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085152"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621685085151"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1250"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621685085152"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621685085151"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1251"></span><span>    </span><span id="local-6989586621685085164"><span class="annot"><span class="annottext">pickExisting :: RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="#local-6989586621685085164"><span class="hs-identifier hs-var hs-var">pickExisting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1252"></span><span>      </span><span id="local-6989586621685085149"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool StandardCrypto) (PoolParams StandardCrypto)
</span><a href="#local-6989586621685085149"><span class="hs-identifier hs-var">psStakePoolParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>      </span><span id="local-6989586621685085148"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085148"><span class="hs-identifier hs-var">avoidKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Set (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-1254"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool StandardCrypto) (PoolParams StandardCrypto)
</span><a href="#local-6989586621685085149"><span class="hs-identifier hs-var">psStakePoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621685085147"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085147"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085147"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621685085148"><span class="hs-identifier hs-var">avoidKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1255"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (KeyHash 'StakePool StandardCrypto, PoolParams StandardCrypto)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era))
</span><a href="#local-6989586621685085165"><span class="hs-identifier hs-var">genNew</span></a></span><span>
</span><span id="line-1256"></span><span>        </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621685085146"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085146"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621685085145"><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085145"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621685085146"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams StandardCrypto
</span><a href="#local-6989586621685085145"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1257"></span></pre></body></html>